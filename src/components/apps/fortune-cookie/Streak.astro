---
import { Icon } from "astro-icon/components";
import type { Application } from "../../../types/apps";

interface Props {
    app: Application;
}

const { app } = Astro.props;
---

<section class="relative py-24 px-6 overflow-hidden bg-black">
    <div class="absolute inset-0 pointer-events-none opacity-20 bg-grid-pattern"></div>

    <div class="max-w-6xl mx-auto flex flex-col md:flex-row items-center gap-16 relative z-10">
        <div class="w-full md:w-1/2 text-left">
            <h2 class="text-4xl md:text-6xl font-serif font-bold text-[#F2E5BD] mb-8 leading-tight">
                La Racha <span class="text-[#BF9F5A]">Sagrada</span>.
            </h2>
            <p class="text-xl md:text-2xl font-light text-white/60 mb-8 leading-relaxed">
                No coleccionas frases, coleccionas constancia. <span
                    class="text-white font-medium border-b border-[#BF9F5A]"
                    >Tu historia se escribe día a día.</span
                >
            </p>

            <div>
                <div
                    class="flex items-center gap-4 bg-[#111] p-4 rounded-xl border border-[#BF9F5A]/30 w-full md:w-fit font-mono"
                >
                    <Icon name="mdi:clock-alert-outline" class="w-6 h-6 shrink-0 text-[#BF9F5A]" />
                    <span
                        id="cookie-countdown"
                        class="text-sm font-bold uppercase tracking-widest text-[#F2E5BD]"
                        >Calculando tiempo...</span
                    >
                </div>
                <p class="text-xs text-white/30 mt-2 uppercase tracking-widest">
                    Aunque tranquilidad, mañana habrá otra
                </p>
            </div>
        </div>

        <div
            class="w-full md:w-1/2 relative bg-[#1A1A1A] p-8 rounded-3xl border border-white/5 shadow-2xl overflow-hidden group hover:border-[#BF9F5A]/20 transition-all duration-500"
        >
            <div
                class="absolute -top-10 -right-10 w-40 h-40 bg-[#BF9F5A] opacity-10 blur-[80px] rounded-full"
            >
            </div>

            <div class="grid grid-cols-4 gap-4 aspect-square">
                {
                    Array.from({ length: 12 }).map((_, i) => {
                        let cookieImg = "/assets/apps/galleta-de-la-fortuna/cookie-closed.webp";
                        let extraClasses = "opacity-80";

                        if (i === 2) {
                            cookieImg = "/assets/apps/galleta-de-la-fortuna/cookie-moon.webp";
                            extraClasses = "brightness-110 contrast-125";
                        }
                        if (i === 5) {
                            cookieImg = "/assets/apps/galleta-de-la-fortuna/cookie-crystal.webp";
                            extraClasses = "grayscale brightness-75";
                        }
                        if (i === 8) {
                            cookieImg = "/assets/apps/galleta-de-la-fortuna/cookie-moon.webp";
                            extraClasses = "brightness-110 contrast-125";
                        }

                        return (
                            <div
                                class={`relative rounded-xl border ${i < 10 ? "border-[#BF9F5A]/20 bg-[#BF9F5A]/5" : "border-white/5 bg-transparent"} flex items-center justify-center aspect-square transition-all duration-300 group-hover:scale-[1.02]`}
                            >
                                {i < 10 && (
                                    <img
                                        src={cookieImg}
                                        alt="Cookie"
                                        class={`w-3/4 h-3/4 object-contain ${extraClasses}`}
                                    />
                                )}
                                {i === 10 && (
                                    <div class="absolute inset-0 bg-[#BF9F5A]/10 animate-pulse rounded-xl border border-[#BF9F5A]/30 flex items-center justify-center">
                                        <span class="text-[#BF9F5A] font-bold text-xs opacity-0 group-hover:opacity-100 transition-opacity">
                                            HOY
                                        </span>
                                    </div>
                                )}
                            </div>
                        );
                    })
                }
            </div>

            <div class="mt-6 flex justify-between items-end">
                <div>
                    <div class="text-[10px] text-white/30 uppercase tracking-[0.2em] mb-1">
                        Tu Altar
                    </div>
                    <div class="text-3xl font-serif text-[#F2E5BD]">Día 10</div>
                </div>
                <div class="text-right">
                    <div class="text-[10px] text-white/30 uppercase tracking-[0.2em] mb-1">
                        Próximo Hito
                    </div>
                    <div class="text-xl font-serif text-white/50">Día 14</div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    function updateCountdown() {
        const now = new Date();
        const tomorrow = new Date(now);
        tomorrow.setDate(tomorrow.getDate() + 1);
        tomorrow.setHours(0, 0, 0, 0);

        const diff = tomorrow.getTime() - now.getTime();

        const hours = Math.floor(diff / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);

        const element = document.getElementById("cookie-countdown");
        if (element) {
            element.innerText = `La galleta de hoy acaba en: ${hours}h ${minutes}m ${seconds}s`;
        }
    }

    setInterval(updateCountdown, 1000);
    updateCountdown();
</script>

<style>
    .bg-grid-pattern {
        background-image: radial-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px);
        background-size: 40px 40px;
    }
</style>
