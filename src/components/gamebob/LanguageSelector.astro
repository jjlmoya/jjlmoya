---
const { currentLang, baseUrl } = Astro.props;

const LANGUAGES = [
    { code: "en", name: "English", flag: "ğŸ‡¬ğŸ‡§" },
    { code: "es", name: "EspaÃ±ol", flag: "ğŸ‡ªğŸ‡¸" },
    { code: "de", name: "Deutsch", flag: "ğŸ‡©ğŸ‡ª" },
    { code: "fr", name: "FranÃ§ais", flag: "ğŸ‡«ğŸ‡·" },
    { code: "it", name: "Italiano", flag: "ğŸ‡®ğŸ‡¹" },
    { code: "pt", name: "PortuguÃªs", flag: "ğŸ‡µğŸ‡¹" },
    { code: "ja", name: "æ—¥æœ¬èª", flag: "ğŸ‡¯ğŸ‡µ" },
    { code: "ko", name: "í•œêµ­ì–´", flag: "ğŸ‡°ğŸ‡·" },
    { code: "zh", name: "ä¸­æ–‡", flag: "ğŸ‡¨ğŸ‡³" },
    { code: "ru", name: "Ğ ÑƒÑÑĞºĞ¸Ğ¹", flag: "ğŸ‡·ğŸ‡º" },
    { code: "tr", name: "TÃ¼rkÃ§e", flag: "ğŸ‡¹ğŸ‡·" },
    { code: "nl", name: "Nederlands", flag: "ğŸ‡³ğŸ‡±" },
    { code: "pl", name: "Polski", flag: "ğŸ‡µğŸ‡±" },
    { code: "sv", name: "Svenska", flag: "ğŸ‡¸ğŸ‡ª" },
    { code: "hi", name: "à¤¹à¤¿à¤¨à¥à¤¦à¥€", flag: "ğŸ‡®ğŸ‡³" },
];

interface Props {
    currentLang?: string;
    baseUrl: string;
}
---

<div
    class="flex flex-wrap justify-center gap-2 mb-12 animate-in fade-in slide-in-from-top-4 duration-1000"
>
    {
        LANGUAGES.map((lang) => (
            <button
                data-lang-btn={lang.code}
                class="px-3 py-1.5 rounded-full text-xs font-medium transition-all duration-300 border lang-btn"
            >
                <span class="mr-1.5">{lang.flag}</span>
                {lang.name}
            </button>
        ))
    }
</div>

<style>
    .lang-btn {
        background-color: rgba(255, 255, 255, 0.05);
        border-color: rgba(255, 255, 255, 0.1);
        color: #9ca3af;
    }
    .lang-btn:hover {
        border-color: rgba(255, 255, 255, 0.3);
        background-color: rgba(255, 255, 255, 0.1);
        color: white;
    }
    .lang-btn.active-lang {
        background-color: rgba(29, 218, 188, 0.2);
        border-color: #1ddabc;
        color: #1ddabc;
        box-shadow: 0 0 15px rgba(29, 218, 188, 0.3);
    }
</style>

<script>
    function setupLangButtons() {
        const buttons = document.querySelectorAll("[data-lang-btn]");
        buttons.forEach((btn) => {
            btn.addEventListener("click", () => {
                const lang = btn.getAttribute("data-lang-btn");
                if (lang) {
                    document.dispatchEvent(
                        new CustomEvent("change-language", { detail: { lang } })
                    );

                    buttons.forEach((b) => b.classList.remove("active-lang"));
                    btn.classList.add("active-lang");

                    localStorage.setItem("preferred-lang", lang);
                }
            });
        });

        const savedLang =
            localStorage.getItem("preferred-lang") || navigator.language.split("-")[0];
        const targetBtn = document.querySelector(`[data-lang-btn="${savedLang}"]`);

        buttons.forEach((b) => b.classList.remove("active-lang"));

        if (targetBtn) {
            targetBtn.classList.add("active-lang");
        } else {
            const esBtn = document.querySelector(`[data-lang-btn="es"]`);
            if (esBtn) esBtn.classList.add("active-lang");
        }
    }

    setupLangButtons();
    document.addEventListener("astro:page-load", setupLangButtons);
</script>
