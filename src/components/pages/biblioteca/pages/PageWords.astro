---
interface Props {
    side: 'left' | 'right';
}
const { side } = Astro.props;
---

{side === 'left' ? (
    <div class="flex items-center justify-center h-full w-full relative overflow-hidden bg-[#0c0a09]">
        <!-- Words Visual: Comic Bla Bla Bla -->
        <div class="relative w-full h-full flex items-center justify-center overflow-hidden">
            
            <!-- Chaotic Background Blas -->
            <div class="absolute inset-0 flex flex-wrap content-center justify-center opacity-10 select-none pointer-events-none">
                {Array.from({ length: 20 }).map((_, _i) => (
                    <span class="text-4xl font-black m-4" style={{ transform: `rotate(${Math.random() * 40 - 20}deg)` }}>BLA</span>
                ))}
            </div>

            <!-- Animated Pop-up Blas -->
            <div class="relative w-64 h-64">
                <div class="absolute top-1/4 left-1/4 text-4xl font-black text-white animate-pop-1 -rotate-12">BLA</div>
                <div class="absolute top-1/2 left-1/2 text-6xl font-black text-white animate-pop-2 rotate-6">BLA</div>
                <div class="absolute bottom-1/4 right-1/4 text-3xl font-black text-white animate-pop-3 -rotate-6">BLA</div>
                <div class="absolute top-1/3 right-1/3 text-5xl font-black text-white animate-pop-4 rotate-12">BLA</div>
                <div class="absolute bottom-1/3 left-1/3 text-2xl font-black text-white animate-pop-5 -rotate-3">bla</div>
                <div class="absolute top-10 right-10 text-xl font-black text-white/50 animate-pop-1 rotate-45">bla?</div>
                <div class="absolute bottom-10 left-10 text-4xl font-black text-white/50 animate-pop-3 -rotate-12">BLA!</div>
            </div>
            
            <!-- Speech Bubble Icon (Central) -->
            <div class="absolute z-10">
                <svg viewBox="0 0 24 24" fill="currentColor" class="w-24 h-24 text-white/10">
                    <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
                </svg>
            </div>

        </div>
    </div>
) : (
    <div class="flex flex-col items-center justify-center h-full text-center space-y-6 max-w-md mx-auto">
        <h3 class="font-serif text-3xl text-yellow-600/60 uppercase tracking-widest">La Voz</h3>
        
        <div class="space-y-2">
            <div class="font-variant-numeric tabular-nums text-4xl md:text-5xl font-bold text-[#e7e5e4]" id="words-count">
                0
            </div>
            <div class="text-sm text-[#e7e5e4]/40 uppercase tracking-wider">Palabras Pronunciadas</div>
        </div>
        
        <p class="font-serif text-xl leading-relaxed text-[#e7e5e4]">
            TANTO RUIDO. TANTAS PALABRAS PARA DECIR TAN POCO. AUNQUE ALGUNAS, SUPONGO, MERECIERON LA PENA.
        </p>
    </div>
)}

<style>
    @keyframes pop {
        0% { transform: scale(0); opacity: 0; }
        50% { transform: scale(1.2); opacity: 1; }
        70% { transform: scale(1); opacity: 1; }
        100% { transform: scale(1.1); opacity: 0; }
    }

    .animate-pop-1 { animation: pop 2s infinite; animation-delay: 0s; }
    .animate-pop-2 { animation: pop 2.5s infinite; animation-delay: 0.5s; }
    .animate-pop-3 { animation: pop 1.8s infinite; animation-delay: 1s; }
    .animate-pop-4 { animation: pop 3s infinite; animation-delay: 1.5s; }
    .animate-pop-5 { animation: pop 2.2s infinite; animation-delay: 0.2s; }
</style>

<script>
    import { calculateWordsStats } from "../../../../utils/libraryLogic";

    const countEl = document.getElementById('words-count');

    document.addEventListener('update-life-stats', (e: any) => {
        const { stats } = e.detail;
        if (!countEl || !stats) return;

        const { wordsSpoken } = calculateWordsStats(stats.daysAlive);
        countEl.innerText = wordsSpoken.toLocaleString();
    });
</script>
