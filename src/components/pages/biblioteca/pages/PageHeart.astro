---
interface Props {
    side: 'left' | 'right';
}
const { side } = Astro.props;
---

{side === 'left' ? (
    <div class="flex items-center justify-center h-full w-full relative">
        
        <div class="absolute inset-0 opacity-20 bg-[radial-gradient(circle_at_center,#3f1d1d_0%,transparent_60%)] blur-2xl"></div>
        
        
        <div class="relative w-64 h-64 md:w-80 md:h-80 animate-heartbeat filter drop-shadow-[0_0_10px_rgba(63,29,29,0.5)]">
            <svg viewBox="0 0 200 200" class="w-full h-full" style="overflow: visible;">
                
                <g opacity="0.2">
                    <circle cx="100" cy="100" r="60" fill="#3f1d1d" filter="url(#rough-edge)" opacity="0.5" />
                    <circle cx="160" cy="40" r="2" fill="#3f1d1d" />
                    <circle cx="40" cy="160" r="3" fill="#3f1d1d" />
                </g>
            
                
                <path d="M100,175 C100,175 35,110 35,65 C35,35 60,25 80,25 C90,25 100,35 100,35 C100,35 110,25 120,25 C140,25 165,35 165,65 C165,110 100,175 100,175 Z" 
                      fill="none" stroke="#3f1d1d" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
                
                
                <path d="M100,175 C98,170 38,108 38,65 C38,38 62,28 80,28 C89,28 98,35 100,35 C102,35 111,28 120,28 C138,28 162,38 162,65 C162,108 102,170 100,175" 
                      fill="none" stroke="#3f1d1d" stroke-width="1" stroke-opacity="0.6" />
            
                
                <path d="M80,25 L80,10 M120,25 L120,10" stroke="#3f1d1d" stroke-width="2" stroke-linecap="round" />
                <path d="M75,10 L85,10 M115,10 L125,10" stroke="#3f1d1d" stroke-width="2" stroke-linecap="round" />
            
                
                <path d="M50,60 L60,70 M45,65 L55,75 M150,60 L140,70 M155,65 L145,75" stroke="#3f1d1d" stroke-width="1" stroke-opacity="0.4" />
                <path d="M100,175 L100,150" stroke="#3f1d1d" stroke-width="1" stroke-opacity="0.3" />
            </svg>
        </div>
    </div>
) : (
    <div class="flex flex-col items-center justify-center h-full text-center space-y-8 max-w-md mx-auto relative z-10">
        <div class="space-y-2">
            <h2 class="font-serif text-4xl md:text-5xl text-[#e7e5e4] font-bold tracking-wide">El Motor</h2>
        </div>
        
        <div class="relative py-8">
            <div class="font-variant-numeric tabular-nums text-5xl md:text-6xl font-bold text-[#e7e5e4] tracking-tight drop-shadow-lg" id="heart-counter">
                0
            </div>
            <div class="text-[#78716c] font-serif italic mt-2">latidos registrados</div>
        </div>
        
        <p class="font-serif text-lg md:text-xl leading-relaxed text-[#a8a29e] max-w-sm uppercase tracking-wide">
            UN PEQUEÃ‘O TAMBOR EN LA OSCURIDAD. GOLPEA SIN DESCANSO, CONTANDO LOS SEGUNDOS HASTA QUE SE DETIENE. ADMIRABLE TENACIDAD.
        </p>
    </div>
)}

<style>
    @keyframes heartbeat {
        0% { transform: scale(1); }
        15% { transform: scale(1.05); }
        30% { transform: scale(1); }
        45% { transform: scale(1.05); }
        60% { transform: scale(1); }
        100% { transform: scale(1); }
    }
    .animate-heartbeat {
        animation: heartbeat 2s ease-in-out infinite;
        will-change: transform;
        transform: translateZ(0); 
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
    }
</style>

<script>
    const counter = document.getElementById('heart-counter');
    let animationFrame: number;

    document.addEventListener('update-life-stats', (e: any) => {
        const { birthdate } = e.detail;
        if (!counter) return;

        
        const start = () => {
            const now = new Date();
            
            const msAlive = now.getTime() - new Date(birthdate).getTime();
            const preciseHeartbeats = msAlive * (80 / 60000);
            
            counter.innerText = Math.floor(preciseHeartbeats).toLocaleString();
            animationFrame = requestAnimationFrame(start);
        };
        
        if (animationFrame) cancelAnimationFrame(animationFrame);
        start();
    });
</script>
