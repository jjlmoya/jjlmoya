---
interface Props {
    side: "left" | "right";
}
const { side } = Astro.props;
---

{
    side === "left" ? (
        <div class="flex items-center justify-center h-full w-full relative overflow-hidden bg-[#0c0a09]">
            <div class="relative w-full h-full flex items-center justify-center">
                <div class="absolute w-64 h-56 bg-purple-900/10 rounded-[50%] blur-3xl animate-pulse-slow" />

                <div class="relative w-72 h-72">
                    <div class="absolute top-1/2 left-1/2 w-1 h-1 bg-purple-400 rounded-full shadow-[0_0_10px_#a855f7] animate-ping" />

                    <svg class="absolute inset-0 w-full h-full overflow-visible opacity-80">
                        <defs>
                            <filter id="glow-purple">
                                <feGaussianBlur stdDeviation="2" result="coloredBlur" />
                                <feMerge>
                                    <feMergeNode in="coloredBlur" />
                                    <feMergeNode in="SourceGraphic" />
                                </feMerge>
                            </filter>
                        </defs>

                        <path
                            d="M144,144 Q100,100 80,140 T40,180"
                            stroke="#c084fc"
                            stroke-width="1"
                            fill="none"
                            class="animate-synapse-1"
                            filter="url(#glow-purple)"
                        />
                        <path
                            d="M144,144 Q110,180 90,200"
                            stroke="#a855f7"
                            stroke-width="0.5"
                            fill="none"
                            class="animate-synapse-2"
                            filter="url(#glow-purple)"
                        />

                        <path
                            d="M144,144 Q180,90 220,110 T280,140"
                            stroke="#d8b4fe"
                            stroke-width="1"
                            fill="none"
                            class="animate-synapse-3"
                            filter="url(#glow-purple)"
                        />
                        <path
                            d="M144,144 Q200,200 240,180"
                            stroke="#9333ea"
                            stroke-width="0.5"
                            fill="none"
                            class="animate-synapse-1"
                            style="animation-delay: 1s;"
                            filter="url(#glow-purple)"
                        />

                        <circle
                            cx="80"
                            cy="140"
                            r="2"
                            fill="#fff"
                            class="animate-flash"
                            style="animation-delay: 0.5s;"
                        />
                        <circle
                            cx="220"
                            cy="110"
                            r="2"
                            fill="#fff"
                            class="animate-flash"
                            style="animation-delay: 1.2s;"
                        />
                        <circle
                            cx="90"
                            cy="200"
                            r="1.5"
                            fill="#fff"
                            class="animate-flash"
                            style="animation-delay: 2.5s;"
                        />
                    </svg>

                    <div class="absolute top-10 left-20 w-1 h-1 bg-purple-200 rounded-full animate-float-idea" />
                    <div
                        class="absolute bottom-20 right-10 w-1.5 h-1.5 bg-purple-300 rounded-full animate-float-idea"
                        style="animation-delay: 2s;"
                    />
                    <div
                        class="absolute top-20 right-20 w-1 h-1 bg-white rounded-full animate-float-idea"
                        style="animation-delay: 4s;"
                    />
                </div>
            </div>
        </div>
    ) : (
        <div class="flex flex-col items-center justify-center h-full text-center space-y-6 max-w-md mx-auto">
            <h3 class="font-serif text-3xl text-purple-600/60 uppercase tracking-widest">
                La Mente
            </h3>

            <div class="space-y-2">
                <div
                    class="font-variant-numeric tabular-nums text-4xl md:text-5xl font-bold text-[#e7e5e4]"
                    id="mind-count"
                >
                    0
                </div>
                <div class="text-sm text-[#e7e5e4]/40 uppercase tracking-wider">Pensamientos</div>
            </div>

            <p
                class="text-xl leading-relaxed text-[#e7e5e4]"
                style="font-family: 'Cinzel', serif; font-variant: small-caps;"
            >
                UNA TORMENTA ELÉCTRICA EN UN TROZO DE CARNE. MILLONES DE IDEAS CHOCANDO ENTRE SÍ. ES
                UN MILAGRO QUE NO OS MAREÉIS.
            </p>
        </div>
    )
}

<style>
    @keyframes synapse-flow {
        0% {
            stroke-dasharray: 0, 1000;
            stroke-dashoffset: 0;
            opacity: 0.2;
        }
        50% {
            stroke-dasharray: 100, 1000;
            stroke-dashoffset: -50;
            opacity: 1;
        }
        100% {
            stroke-dasharray: 0, 1000;
            stroke-dashoffset: -200;
            opacity: 0.2;
        }
    }

    @keyframes flash {
        0%,
        100% {
            opacity: 0;
            transform: scale(1);
        }
        5% {
            opacity: 1;
            transform: scale(1.5);
        }
        10% {
            opacity: 0;
            transform: scale(1);
        }
    }

    @keyframes float-idea {
        0% {
            transform: translate(0, 0) scale(1);
            opacity: 0;
        }
        20% {
            opacity: 0.8;
        }
        80% {
            opacity: 0.8;
        }
        100% {
            transform: translate(var(--tx, 20px), var(--ty, -30px)) scale(0);
            opacity: 0;
        }
    }

    @keyframes pulse-slow {
        0%,
        100% {
            opacity: 0.3;
            transform: scale(1);
        }
        50% {
            opacity: 0.5;
            transform: scale(1.1);
        }
    }

    .animate-synapse-1 {
        stroke-dasharray: 200;
        animation: synapse-flow 3s linear infinite;
    }
    .animate-synapse-2 {
        stroke-dasharray: 200;
        animation: synapse-flow 4s linear infinite;
    }
    .animate-synapse-3 {
        stroke-dasharray: 200;
        animation: synapse-flow 2.5s linear infinite;
    }

    .animate-flash {
        animation: flash 3s ease-out infinite;
    }

    .animate-float-idea {
        animation: float-idea 5s ease-in-out infinite;
    }

    .animate-pulse-slow {
        animation: pulse-slow 6s ease-in-out infinite;
    }
</style>

<script>
    import { calculateMindStats } from "../../../../utils/libraryLogic";

    const countEl = document.getElementById("mind-count");

    document.addEventListener("update-life-stats", (e: any) => {
        const { stats } = e.detail;
        if (!countEl || !stats) return;

        const { thoughts } = calculateMindStats(stats.daysAlive);

        countEl.innerText = Math.floor(thoughts).toLocaleString();
    });
</script>
