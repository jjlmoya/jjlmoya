---
interface Props {
    side: 'left' | 'right';
}
const { side } = Astro.props;
---

{side === 'left' ? (
    <div class="flex items-center justify-center h-full w-full relative overflow-hidden bg-[#0c0a09]">
        
        <div class="relative w-48 h-48 rounded-full bg-[#e7e5e4] shadow-[0_0_50px_rgba(231,229,228,0.2)] overflow-hidden">
             
             <div class="absolute top-10 left-10 w-8 h-8 rounded-full bg-[#d6d3d1] opacity-50"></div>
             <div class="absolute bottom-12 right-12 w-12 h-12 rounded-full bg-[#d6d3d1] opacity-40"></div>
             <div class="absolute top-1/2 left-1/2 w-6 h-6 rounded-full bg-[#d6d3d1] opacity-60"></div>
             
             
             <div class="absolute inset-0 bg-black/80 rounded-full animate-moon-phase origin-left mix-blend-multiply"></div>
        </div>
    </div>
) : (
    <div class="flex flex-col items-center justify-center h-full text-center space-y-6 max-w-md mx-auto">
        <h3 class="font-serif text-3xl text-gray-400/60 uppercase tracking-widest">Las Lunas</h3>
        
        <div class="space-y-2">
            <div class="font-variant-numeric tabular-nums text-4xl md:text-5xl font-bold text-[#e7e5e4]" id="moon-count">
                0
            </div>
            <div class="text-sm text-[#e7e5e4]/40 uppercase tracking-wider">Lunas Llenas Vividas</div>
        </div>
        
        <p class="font-serif text-xl leading-relaxed text-[#e7e5e4]">
            LA PLATA QUE SE ESCAPA. HAS VISTO AL LOBO AULLAR <span id="moon-count-text" class="text-gray-400">0 VECES</span>. Y AÚN ASÍ, LA NOCHE SIEMPRE VUELVE.
        </p>
    </div>
)}

<style>
    @keyframes moon-phase {
        0% { transform: translateX(100%); }
        50% { transform: translateX(0); }
        100% { transform: translateX(-100%); }
    }
    .animate-moon-phase {
        animation: moon-phase 10s linear infinite;
    }
</style>

<script>
    import { calculateMoonStats } from "../../../../utils/libraryLogic";

    const countEl = document.getElementById('moon-count');
    const textEl = document.getElementById('moon-count-text');

    document.addEventListener('update-life-stats', (e: any) => {
        const { stats } = e.detail;
        if (!countEl || !stats) return;

        const { fullMoons } = calculateMoonStats(stats.daysAlive);
        
        countEl.innerText = fullMoons.toLocaleString();
        if (textEl) textEl.innerText = `${fullMoons.toLocaleString()} VECES`;
    });
</script>
