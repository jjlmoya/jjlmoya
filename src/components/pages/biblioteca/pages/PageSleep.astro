---
interface Props {
    side: "left" | "right";
}
const { side } = Astro.props;
---

{
    side === "left" ? (
        <div class="flex items-center justify-center h-full w-full relative overflow-hidden bg-[#0c0a09]">
            <div class="relative w-full h-full flex items-center justify-center p-8">
                <div class="relative w-64 h-64 md:w-72 md:h-72">
                    <div class="absolute inset-0 rounded-full border border-[#292524] bg-[#0c0a09] shadow-2xl" />

                    <div
                        class="absolute inset-0 rounded-full opacity-80"
                        style="background: conic-gradient(from 180deg, #172554 0deg, #3b82f6 120deg, transparent 120deg);"
                    />

                    <div
                        class="absolute inset-0 rounded-full overflow-hidden"
                        style="clip-path: polygon(50% 50%, 50% 100%, 0% 75%, 0% 25%, 15% 0%); transform: rotate(180deg);"
                    >
                        <div class="absolute top-1/2 left-1/2 w-1 h-1 bg-white rounded-full animate-pulse" />
                        <div class="absolute top-3/4 left-1/3 w-0.5 h-0.5 bg-blue-200 rounded-full animate-pulse delay-75" />
                        <div class="absolute top-2/3 left-1/4 w-1 h-1 bg-white/80 rounded-full animate-pulse delay-150" />
                        <div class="absolute top-1/3 left-1/2 w-0.5 h-0.5 bg-white rounded-full animate-pulse delay-300" />
                    </div>

                    <div class="absolute inset-6 md:inset-8 rounded-full bg-[#0c0a09] flex items-center justify-center border border-[#292524] z-10 shadow-[inset_0_0_20px_rgba(0,0,0,0.8)]">
                        <div class="text-center">
                            <span class="block text-3xl md:text-4xl font-bold text-blue-200 font-variant-numeric">
                                ~33%
                            </span>
                            <span class="block text-[10px] md:text-xs uppercase tracking-widest text-blue-400/60 mt-1">
                                Inconsciente
                            </span>
                        </div>
                    </div>

                    <div class="absolute -inset-4 rounded-full border border-blue-500/10 border-dashed animate-spin-slow pointer-events-none" />
                </div>
            </div>
        </div>
    ) : (
        <div class="flex flex-col items-center justify-center h-full text-center space-y-6 max-w-md mx-auto">
            <h3 class="font-serif text-3xl text-blue-400/60 uppercase tracking-widest">
                El Letargo
            </h3>

            <div class="space-y-2">
                <div
                    class="font-variant-numeric tabular-nums text-4xl md:text-5xl font-bold text-[#e7e5e4]"
                    id="sleep-hours"
                >
                    0
                </div>
                <div class="text-sm text-[#e7e5e4]/40 uppercase tracking-wider">Horas Dormidas</div>
            </div>

            <p
                class="text-xl leading-relaxed text-[#e7e5e4]"
                style="font-family: 'Cinzel', serif; font-variant: small-caps;"
            >
                PASÁIS UN TERCIO DE LA EXISTENCIA INCONSCIENTES. Y LUEGO OS QUEJÁIS DE QUE LA VIDA
                ES CORTA. CURIOSA GESTIÓN DEL TIEMPO.
            </p>
        </div>
    )
}

<style>
    @keyframes spin-slow {
        from {
            transform: rotate(0deg);
        }
        to {
            transform: rotate(360deg);
        }
    }
    .animate-spin-slow {
        animation: spin-slow 60s linear infinite;
    }
</style>

<script>
    import { calculateSleepStats } from "../../../../utils/libraryLogic";

    const hoursEl = document.getElementById("sleep-hours");

    document.addEventListener("update-life-stats", (e: any) => {
        const { stats } = e.detail;
        if (!hoursEl || !stats) return;

        const { hoursSlept } = calculateSleepStats(stats.hoursAlive);

        hoursEl.innerText = hoursSlept.toLocaleString();
    });
</script>
