---
interface Props {
    side: 'left' | 'right';
}
const { side } = Astro.props;
---

{side === 'left' ? (
    <div class="flex items-center justify-center h-full w-full relative overflow-hidden bg-[#0c0a09]">
        <!-- Food Visual: Steaming Curry (Serious & Atmospheric) -->
        <div class="relative w-full h-full flex flex-col items-center justify-center">
             
             <!-- Steam Container -->
             <div class="relative w-full h-48 flex justify-center overflow-hidden pointer-events-none opacity-60">
                <!-- Steam Layers -->
                <div class="absolute bottom-0 w-20 h-40 bg-stone-400/10 blur-2xl rounded-full animate-steam-rise" style="animation-delay: 0s;"></div>
                <div class="absolute bottom-0 w-24 h-48 bg-stone-300/5 blur-3xl rounded-full animate-steam-rise" style="animation-delay: 1.5s;"></div>
                <div class="absolute bottom-0 w-16 h-32 bg-amber-500/5 blur-2xl rounded-full animate-steam-rise" style="animation-delay: 2.5s;"></div>
                <div class="absolute bottom-[-20px] w-32 h-32 bg-white/5 blur-xl rounded-full animate-steam-base"></div>
             </div>

             <!-- The Bowl -->
             <div class="relative z-10">
                 <!-- Bowl Body -->
                 <div class="w-48 h-20 bg-gradient-to-b from-[#292524] to-[#0c0a09] rounded-b-[4rem] border-t border-[#44403c]/30 shadow-2xl relative overflow-hidden">
                    <!-- Reflection/Shine -->
                    <div class="absolute top-2 left-4 w-40 h-10 bg-white/5 blur-md rounded-full transform -rotate-3 opacity-30"></div>
                 </div>
                 
                 <!-- Curry Surface (Visible at top edge) -->
                 <div class="absolute -top-3 left-2 w-44 h-6 bg-[#b45309] rounded-[100%] opacity-90 blur-[0.5px] shadow-[inset_0_2px_10px_rgba(0,0,0,0.5)]"></div>
                 
                 <!-- Bowl Rim (Back) -->
                 <div class="absolute -top-4 left-0 w-48 h-8 rounded-[100%] border border-[#44403c]/20 z-[-1]"></div>
             </div>

             <!-- Shadow Base -->
             <div class="w-40 h-4 bg-black/60 blur-lg rounded-[100%] mt-2"></div>

        </div>
    </div>
) : (
    <div class="flex flex-col items-center justify-center h-full text-center space-y-6 max-w-md mx-auto">
        <h3 class="font-serif text-3xl text-amber-700/60 uppercase tracking-widest">El Hambre</h3>
        
        <div class="space-y-2">
            <div class="font-variant-numeric tabular-nums text-4xl md:text-5xl font-bold text-[#e7e5e4]" id="food-count">
                0
            </div>
            <div class="text-sm text-[#e7e5e4]/40 uppercase tracking-wider">Toneladas Ingeridas</div>
        </div>
        
        <p class="text-xl leading-relaxed text-[#e7e5e4]" style="font-family: 'Cinzel', serif; font-variant: small-caps;">
            LA MÁQUINA NECESITA COMBUSTIBLE. HABÉIS DEVORADO <span id="food-kg" class="text-amber-700">0 KG</span> DE MATERIA. VIDA QUE SE CONVIERTE EN VIDA. ESPERO QUE AL MENOS UNA PARTE HAYA SIDO CURRY. ME HAN DICHO QUE ES UNA EXPERIENCIA INTENSA.
        </p>
    </div>
)}

<style>
    @keyframes steam-rise {
        0% { transform: translateY(20px) scaleX(0.8); opacity: 0; }
        20% { opacity: 0.5; }
        50% { transform: translateY(-30px) scaleX(1.1); opacity: 0.3; }
        100% { transform: translateY(-80px) scaleX(1.5); opacity: 0; }
    }
    
    @keyframes steam-base {
        0%, 100% { opacity: 0.2; transform: scale(1); }
        50% { opacity: 0.4; transform: scale(1.1); }
    }

    .animate-steam-rise {
        animation: steam-rise 5s ease-out infinite;
    }
    .animate-steam-base {
        animation: steam-base 4s ease-in-out infinite;
    }
</style>

<script>
    import { calculateFoodStats } from "../../../../utils/libraryLogic";

    const countEl = document.getElementById('food-count');
    const kgEl = document.getElementById('food-kg');

    document.addEventListener('update-life-stats', (e: any) => {
        const { stats } = e.detail;
        if (!countEl || !stats) return;

        const { kgEaten, tonsEaten } = calculateFoodStats(stats.daysAlive);
        
        countEl.innerText = tonsEaten.toFixed(2).replace('.', ',');
        if (kgEl) kgEl.innerText = `${Math.floor(kgEaten).toLocaleString()} KG`;
    });
</script>
