---

---

<section
    class="min-h-screen flex flex-col items-center justify-center relative py-20 bg-neutral-950 text-white"
>
    <div class="container mx-auto px-6 max-w-6xl">
        <div class="text-center mb-16 space-y-4">
            <h2
                class="text-4xl md:text-6xl font-bold bg-clip-text text-transparent bg-gradient-to-b from-white to-neutral-500"
            >
                Tu Huella Digital
            </h2>
            <p class="text-neutral-400 max-w-2xl mx-auto text-lg">
                Hemos estado midiendo tu comportamiento mientras leías sobre la medición. Aquí están
                tus estadísticas de sesión.
            </p>
        </div>

        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-12">
            
            <div
                class="bg-neutral-900/50 rounded-2xl p-6 border border-neutral-800 backdrop-blur-sm col-span-1 md:col-span-2 lg:col-span-2 relative overflow-hidden group"
            >
                <div
                    class="absolute inset-0 bg-gradient-to-r from-cyan-500/10 to-blue-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500"
                >
                </div>
                <div class="relative z-10">
                    <div class="flex items-baseline gap-2 mb-2">
                        <span class="text-xs font-mono uppercase tracking-widest text-cyan-400"
                            >Distancia Recorrida</span
                        >
                    </div>
                    <div class="flex items-baseline gap-4">
                        <span
                            id="stat-pixels"
                            class="text-4xl md:text-5xl font-bold font-mono text-white">0</span
                        >
                        <span class="text-neutral-500 font-mono">px</span>
                    </div>
                    <div
                        class="mt-4 flex items-center gap-4 text-sm text-neutral-400 font-mono border-t border-white/5 pt-4"
                    >
                        <div class="flex-1">
                            <span id="stat-meters" class="text-white font-bold">0.00</span> m
                        </div>
                        <div class="w-px h-4 bg-white/10"></div>
                        <div class="flex-1 text-right">
                            <span id="stat-scale" class="text-cyan-200">Microscópico</span>
                        </div>
                    </div>
                </div>
            </div>

            
            <div
                class="bg-neutral-900/50 rounded-2xl p-6 border border-neutral-800 backdrop-blur-sm col-span-1 md:col-span-1 relative overflow-hidden group"
            >
                <div
                    class="absolute inset-0 bg-gradient-to-br from-purple-500/10 to-pink-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500"
                >
                </div>
                <div class="relative z-10">
                    <span class="text-xs font-mono uppercase tracking-widest text-purple-400"
                        >Tiempo de Vida</span
                    >
                    <div class="mt-2 flex items-baseline gap-2">
                        <span id="stat-time" class="text-4xl font-bold font-mono text-white"
                            >00:00</span
                        >
                    </div>
                    <p class="text-xs text-neutral-500 mt-2">Invertido en esta página</p>
                </div>
            </div>

            
            <div
                class="bg-neutral-900/50 rounded-2xl p-6 border border-neutral-800 backdrop-blur-sm col-span-1 md:col-span-1 relative overflow-hidden group"
            >
                <div
                    class="absolute inset-0 bg-gradient-to-br from-emerald-500/10 to-green-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500"
                >
                </div>
                <div class="relative z-10">
                    <span class="text-xs font-mono uppercase tracking-widest text-emerald-400"
                        >Velocidad</span
                    >
                    <div class="mt-2 flex items-baseline gap-2">
                        <span id="stat-speed" class="text-4xl font-bold font-mono text-white"
                            >0</span
                        >
                        <span class="text-sm text-neutral-500">px/s</span>
                    </div>
                    <p class="text-xs text-neutral-500 mt-2">Ritmo de consumo</p>
                </div>
            </div>

            
            <div
                class="bg-neutral-900/50 rounded-2xl p-6 border border-neutral-800 backdrop-blur-sm col-span-1 md:col-span-2 lg:col-span-3 relative overflow-hidden group"
            >
                <div
                    class="absolute inset-0 bg-gradient-to-r from-orange-500/10 to-red-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500"
                >
                </div>
                <div
                    class="relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-6"
                >
                    <div>
                        <span class="text-xs font-mono uppercase tracking-widest text-orange-400"
                            >Tu Obsesión</span
                        >
                        <h3
                            id="stat-obsession-title"
                            class="text-2xl md:text-3xl font-serif italic text-white mt-2"
                        >
                            Calculando...
                        </h3>
                        <p class="text-sm text-neutral-400 mt-1">
                            La sección que más ha capturado tu atención.
                        </p>
                    </div>
                    <div class="text-right">
                        <span
                            id="stat-obsession-time"
                            class="text-4xl font-bold font-mono text-orange-200">0s</span
                        >
                        <p class="text-xs text-neutral-500 uppercase tracking-widest mt-1">
                            Dedicados
                        </p>
                    </div>
                </div>
            </div>

            
            <div
                class="bg-neutral-900/50 rounded-2xl p-6 border border-neutral-800 backdrop-blur-sm col-span-1 md:col-span-1 relative overflow-hidden group"
            >
                <div
                    class="absolute inset-0 bg-gradient-to-br from-yellow-500/10 to-amber-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500"
                >
                </div>
                <div class="relative z-10">
                    <span class="text-xs font-mono uppercase tracking-widest text-yellow-400"
                        >Eventos</span
                    >
                    <div class="grid grid-cols-2 gap-4 mt-4">
                        <div>
                            <div id="stat-clicks" class="text-2xl font-bold font-mono text-white">
                                0
                            </div>
                            <div class="text-[10px] text-neutral-500 uppercase">Clicks</div>
                        </div>
                        <div>
                            <div id="stat-scrolls" class="text-2xl font-bold font-mono text-white">
                                0
                            </div>
                            <div class="text-[10px] text-neutral-500 uppercase">Swipes</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="text-center">
            <p class="text-neutral-500 text-sm mb-8 font-mono">
                "Lo que no se mide, no se puede mejorar." — Lord Kelvin <br />
                <span class="text-neutral-700 text-xs"
                    >(Pero lo que se mide demasiado, pierde su alma)</span
                >
            </p>

            <a
                href="/conceptos/"
                class="inline-block px-8 py-3 bg-white text-black hover:bg-neutral-200 transition-colors rounded-full text-sm font-bold uppercase tracking-widest"
            >
                Volver a Conceptos
            </a>
        </div>
    </div>
</section>

<script>
    
    const pixelsEl = document.getElementById("stat-pixels");
    const metersEl = document.getElementById("stat-meters");
    const scaleEl = document.getElementById("stat-scale");
    const timeEl = document.getElementById("stat-time");
    const speedEl = document.getElementById("stat-speed");
    const obsessionTitleEl = document.getElementById("stat-obsession-title");
    const obsessionTimeEl = document.getElementById("stat-obsession-time");
    const clicksEl = document.getElementById("stat-clicks");
    const scrollsEl = document.getElementById("stat-scrolls");

    
    const startTime = Date.now();
    let totalClicks = 0;
    let totalScrollEvents = 0; 
    let maxScrollY = 0;

    
    const sectionTimes = new Map<string, number>();
    let currentSectionId: string | null = null;
    let lastSectionEnterTime = Date.now();

    
    const PIXEL_TO_METER = 0.0002645833;

    
    function formatTime(ms: number) {
        const seconds = Math.floor(ms / 1000);
        const m = Math.floor(seconds / 60);
        const s = seconds % 60;
        return `${m.toString().padStart(2, "0")}:${s.toString().padStart(2, "0")}`;
    }

    function getScaleLabel(meters: number) {
        if (meters < 0.01) return "Microscópico";
        if (meters < 0.1) return "Insecto";
        if (meters < 0.5) return "Manual";
        if (meters < 1.5) return "Humano";
        if (meters < 3.0) return "Habitación";
        if (meters < 10.0) return "Arquitectónico";
        return "Geográfico";
    }

    

    
    
    const observer = new IntersectionObserver(
        (entries: IntersectionObserverEntry[]) => {
            const now = Date.now();

            
            if (currentSectionId) {
                const timeSpent = now - lastSectionEnterTime;
                const currentTotal = sectionTimes.get(currentSectionId) || 0;
                sectionTimes.set(currentSectionId, currentTotal + timeSpent);
            }

            
            let maxRatio = 0;
            let bestEntry: IntersectionObserverEntry | null = null;

            entries.forEach((entry) => {
                if (entry.isIntersecting && entry.intersectionRatio > maxRatio) {
                    maxRatio = entry.intersectionRatio;
                    bestEntry = entry;
                }
            });

            if (bestEntry) {
                
                const target = (bestEntry as IntersectionObserverEntry).target;
                const title =
                    target.querySelector("h2")?.textContent || target.id || "Introducción";

                currentSectionId = title;
                lastSectionEnterTime = now;
            }
        },
        { threshold: [0.2, 0.5, 0.8] }
    );

    
    document.querySelectorAll("main > section").forEach((section) => {
        observer.observe(section);
    });

    
    window.addEventListener("click", () => {
        totalClicks++;
        if (clicksEl) clicksEl.innerText = totalClicks.toString();
    });

    let scrollTimeout: number | null = null;
    window.addEventListener("scroll", () => {
        const scrollY = window.scrollY;
        maxScrollY = Math.max(maxScrollY, scrollY);

        
        if (!scrollTimeout) {
            totalScrollEvents++;
            if (scrollsEl) scrollsEl.innerText = totalScrollEvents.toString();
            scrollTimeout = window.setTimeout(() => {
                scrollTimeout = null;
            }, 100);
        }

        updateRealtimeStats();
    });

    
    function updateRealtimeStats() {
        const now = Date.now();
        const elapsedSeconds = (now - startTime) / 1000;

        
        const scrollY = window.scrollY;
        const meters = scrollY * PIXEL_TO_METER;

        if (pixelsEl) pixelsEl.innerText = Math.floor(scrollY).toLocaleString();
        if (metersEl) metersEl.innerText = meters.toFixed(2);
        if (scaleEl) scaleEl.innerText = getScaleLabel(meters);

        
        if (timeEl) timeEl.innerText = formatTime(now - startTime);

        
        const speed = elapsedSeconds > 0 ? Math.floor(scrollY / elapsedSeconds) : 0;
        if (speedEl) speedEl.innerText = speed.toString();

        
        
        if (currentSectionId) {
            const timeSpent = now - lastSectionEnterTime;
            const currentTotal = sectionTimes.get(currentSectionId) || 0;
            
            const tempMap = new Map(sectionTimes);
            tempMap.set(currentSectionId, currentTotal + timeSpent);

            let maxTime = 0;
            let maxTitle = "Analizando...";

            tempMap.forEach((time, title) => {
                
                if (
                    time > maxTime &&
                    !title.includes("Escala Cósmica") &&
                    !title.includes("Huella")
                ) {
                    maxTime = time;
                    maxTitle = title;
                }
            });

            if (obsessionTitleEl)
                obsessionTitleEl.innerText =
                    maxTitle.length > 30 ? maxTitle.substring(0, 30) + "..." : maxTitle;
            if (obsessionTimeEl) obsessionTimeEl.innerText = (maxTime / 1000).toFixed(1) + "s";
        }
    }

    
    setInterval(updateRealtimeStats, 1000);
</script>
