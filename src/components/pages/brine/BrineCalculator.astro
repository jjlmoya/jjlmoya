---

---

<div
    class="w-full max-w-4xl mx-auto bg-white dark:bg-slate-900 rounded-3xl shadow-2xl overflow-hidden border border-slate-200 dark:border-slate-800"
>
    <div class="grid lg:grid-cols-2 gap-0">
        
        <div class="p-8 lg:p-10 space-y-8">
            <div class="space-y-2">
                <h2 class="text-2xl font-bold text-slate-900 dark:text-white">Calculadora</h2>
                <p class="text-slate-500 dark:text-slate-400 text-sm">
                    Introduce los pesos para calcular el equilibrio perfecto.
                </p>
            </div>

            
            <div class="space-y-6">
                
                <div class="group">
                    <label
                        for="weight-product"
                        class="block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2 group-focus-within:text-cyan-600 dark:group-focus-within:text-cyan-400 transition-colors"
                    >
                        Peso del Producto (g)
                    </label>
                    <div class="relative">
                        <input
                            type="number"
                            id="weight-product"
                            value="500"
                            min="0"
                            class="block w-full px-4 py-4 text-xl bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-2xl focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 outline-none transition-all text-slate-900 dark:text-white font-mono"
                        />
                        <span
                            class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 font-medium"
                            >g</span
                        >
                    </div>
                </div>

                
                <div class="group">
                    <label
                        for="weight-water"
                        class="block text-sm font-medium text-slate-500 dark:text-slate-400 mb-2 group-focus-within:text-blue-600 dark:group-focus-within:text-blue-400 transition-colors"
                    >
                        Peso del Agua (g)
                    </label>
                    <div class="relative">
                        <input
                            type="number"
                            id="weight-water"
                            value="500"
                            min="0"
                            class="block w-full px-4 py-4 text-xl bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-2xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all text-slate-900 dark:text-white font-mono"
                        />
                        <span
                            class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 font-medium"
                            >g</span
                        >
                    </div>
                </div>

                
                <div class="pt-4">
                    <div class="flex justify-between items-end mb-4">
                        <label
                            for="salinity-slider"
                            class="block text-sm font-medium text-slate-500 dark:text-slate-400"
                        >
                            Salinidad Deseada
                        </label>
                        <div class="flex items-baseline gap-1">
                            <span
                                id="salinity-display"
                                class="text-3xl font-bold text-cyan-600 dark:text-cyan-400"
                                >2.0</span
                            >
                            <span class="text-lg text-cyan-600/70 dark:text-cyan-400/70 font-bold"
                                >%</span
                            >
                        </div>
                    </div>
                    <input
                        type="range"
                        id="salinity-slider"
                        min="0.5"
                        max="10"
                        step="0.1"
                        value="1.5"
                        class="w-full h-3 bg-slate-200 dark:bg-slate-700 rounded-full appearance-none cursor-pointer accent-cyan-600 dark:accent-cyan-400 hover:accent-cyan-500 transition-all"
                    />

                    
                    <div class="flex flex-wrap gap-2 mt-4">
                        <button
                            class="preset-btn px-3 py-1.5 text-xs font-bold bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-lg hover:bg-cyan-100 dark:hover:bg-cyan-900/30 hover:text-cyan-700 dark:hover:text-cyan-300 transition-colors border border-transparent hover:border-cyan-200 dark:hover:border-cyan-800"
                            data-value="1.5"
                        >
                            Carnes (1.5%)
                        </button>
                        <button
                            class="preset-btn px-3 py-1.5 text-xs font-bold bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-lg hover:bg-emerald-100 dark:hover:bg-emerald-900/30 hover:text-emerald-700 dark:hover:text-emerald-300 transition-colors border border-transparent hover:border-emerald-200 dark:hover:border-emerald-800"
                            data-value="2.0"
                        >
                            Fermentados (2.0%)
                        </button>
                        <button
                            class="preset-btn px-3 py-1.5 text-xs font-bold bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-lg hover:bg-orange-100 dark:hover:bg-orange-900/30 hover:text-orange-700 dark:hover:text-orange-300 transition-colors border border-transparent hover:border-orange-200 dark:hover:border-orange-800"
                            data-value="3.5"
                        >
                            Salsas (3.5%)
                        </button>
                        <button
                            class="preset-btn px-3 py-1.5 text-xs font-bold bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-lg hover:bg-rose-100 dark:hover:bg-rose-900/30 hover:text-rose-700 dark:hover:text-rose-300 transition-colors border border-transparent hover:border-rose-200 dark:hover:border-rose-800"
                            data-value="5.0"
                        >
                            Conservas (5.0%)
                        </button>
                    </div>
                </div>

                
                <div
                    class="flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800/50 rounded-2xl border border-slate-100 dark:border-slate-700/50"
                >
                    <div>
                        <label
                            for="sugar-toggle"
                            class="font-medium text-slate-700 dark:text-slate-200 cursor-pointer select-none block"
                        >
                            Añadir Azúcar
                        </label>
                        <span class="text-xs text-slate-500 dark:text-slate-400"
                            >Equilibra el sabor y ayuda al dorado (50% de la sal)</span
                        >
                    </div>
                    <div class="relative inline-block w-12 h-6 transition duration-200 ease-in-out">
                        <input
                            type="checkbox"
                            id="sugar-toggle"
                            class="peer absolute w-full h-full opacity-0 z-10 cursor-pointer"
                        />
                        <div
                            class="block w-full h-full bg-slate-300 dark:bg-slate-600 rounded-full peer-checked:bg-purple-500 transition-colors duration-200"
                        >
                        </div>
                        <div
                            class="absolute top-1 left-1 w-4 h-4 bg-white rounded-full shadow-sm transition-transform duration-200 peer-checked:translate-x-6"
                        >
                        </div>
                    </div>
                </div>
            </div>
        </div>

        
        <div
            class="bg-slate-50 dark:bg-slate-800/50 p-8 lg:p-10 flex flex-col justify-between border-t lg:border-t-0 lg:border-l border-slate-200 dark:border-slate-800 relative overflow-hidden"
        >
            
            <div class="relative flex-grow flex items-center justify-center min-h-[300px] mb-8">
                
                <div
                    class="relative w-48 h-64 border-4 border-slate-300 dark:border-slate-600 rounded-2xl rounded-t-none border-t-0 bg-white/50 dark:bg-white/5 backdrop-blur-sm overflow-hidden"
                >
                    
                    <div
                        class="absolute -top-1 left-1/2 -translate-x-1/2 w-52 h-4 bg-slate-300 dark:bg-slate-600 rounded-t-lg"
                    >
                    </div>

                    
                    <div
                        id="vis-water"
                        class="absolute bottom-0 left-0 w-full bg-blue-500/20 transition-all duration-500 ease-out"
                        style="height: 50%"
                    >
                        <div class="absolute top-0 left-0 w-full h-full animate-wave opacity-50">
                        </div>
                    </div>

                    
                    <div
                        id="vis-product"
                        class="absolute bottom-4 left-1/2 -translate-x-1/2 bg-slate-800/10 dark:bg-white/10 rounded-xl transition-all duration-500 ease-out backdrop-blur-sm border border-slate-900/10 dark:border-white/10"
                        style="width: 60%; height: 40%"
                    >
                        <div class="w-full h-full flex items-center justify-center">
                            <span
                                class="text-xs font-bold text-slate-400/50 uppercase tracking-widest"
                                >Producto</span
                            >
                        </div>
                    </div>

                    
                    <div id="vis-particles" class="absolute inset-0 pointer-events-none">
                        
                    </div>
                </div>

                
                <div class="absolute top-0 right-0 space-y-2">
                    <div
                        class="bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg shadow-sm border border-slate-100 dark:border-slate-700 text-xs font-mono text-slate-500 dark:text-slate-400"
                    >
                        Total: <span id="vis-total-weight">1000</span>g
                    </div>
                </div>
            </div>

            
            <div class="space-y-4">
                <div
                    class="bg-white dark:bg-slate-900 p-6 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 relative overflow-hidden group"
                >
                    <div
                        class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="w-16 h-16 text-cyan-500"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            ><path d="M20 12V8H6a2 2 0 0 1-2-2c0-1.1.9-2 2-2h12v4"></path><path
                                d="M4 6v12c0 1.1.9 2 2 2h14v-4"></path><path
                                d="M18 12a2 2 0 0 0-2 2c0 1.1.9 2 2 2h4v-4h-4z"></path></svg
                        >
                    </div>

                    <div class="relative z-10">
                        <span
                            class="block text-sm font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-1"
                            >Sal Necesaria</span
                        >
                        <div class="flex items-baseline gap-2">
                            <span
                                id="result-salt"
                                class="text-5xl font-black text-cyan-600 dark:text-cyan-400 tracking-tight"
                                >20</span
                            >
                            <span class="text-xl font-medium text-slate-400">gramos</span>
                        </div>
                    </div>
                </div>

                <div
                    id="sugar-result-panel"
                    class="hidden bg-white dark:bg-slate-900 p-6 rounded-2xl shadow-sm border border-purple-200 dark:border-purple-900/50 relative overflow-hidden group transition-all duration-300"
                >
                    <div
                        class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="w-16 h-16 text-purple-500"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            ><path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path></svg
                        >
                    </div>

                    <div class="relative z-10">
                        <span
                            class="block text-sm font-bold text-purple-500 dark:text-purple-400 uppercase tracking-wider mb-1"
                            >Azúcar (Opcional)</span
                        >
                        <div class="flex items-baseline gap-2">
                            <span
                                id="result-sugar"
                                class="text-4xl font-black text-purple-600 dark:text-purple-400 tracking-tight"
                                >10</span
                            >
                            <span class="text-lg font-medium text-slate-400">gramos</span>
                        </div>
                    </div>
                </div>

                <div
                    class="bg-white dark:bg-slate-900 p-6 rounded-2xl shadow-sm border border-amber-200 dark:border-amber-900/50 relative overflow-hidden group"
                >
                    <div
                        class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            class="w-16 h-16 text-amber-500"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            ><circle cx="12" cy="12" r="10"></circle><polyline
                                points="12 6 12 12 16 14"></polyline></svg
                        >
                    </div>

                    <div class="relative z-10">
                        <span
                            id="result-time-label"
                            class="block text-sm font-bold text-amber-500 dark:text-amber-400 uppercase tracking-wider mb-1"
                            >Tiempo Estimado</span
                        >
                        <div class="flex items-baseline gap-2">
                            <span
                                id="result-time"
                                class="text-3xl font-black text-amber-600 dark:text-amber-400 tracking-tight"
                                >1 - 3 Semanas</span
                            >
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    @keyframes float {
        0% {
            transform: translateY(0px);
        }
        50% {
            transform: translateY(-5px);
        }
        100% {
            transform: translateY(0px);
        }
    }
    .animate-float {
        animation: float 3s ease-in-out infinite;
    }

    
    @keyframes wave {
        0% {
            transform: translateX(0) translateZ(0) scaleY(1);
        }
        50% {
            transform: translateX(-25%) translateZ(0) scaleY(0.85);
        }
        100% {
            transform: translateX(-50%) translateZ(0) scaleY(1);
        }
    }
    .animate-wave {
        background: repeat-x bottom left;
        background-size: 200% 100%;
        animation: wave 10s linear infinite;
    }
</style>

<script>
    
    const state = {
        product: 500,
        water: 500,
        salinity: 1.5,
        sugar: false,
    };

    
    const els = {
        inputs: {
            product: document.getElementById("weight-product") as HTMLInputElement,
            water: document.getElementById("weight-water") as HTMLInputElement,
            slider: document.getElementById("salinity-slider") as HTMLInputElement,
            sugar: document.getElementById("sugar-toggle") as HTMLInputElement,
            presets: document.querySelectorAll(".preset-btn"),
        },
        displays: {
            salinity: document.getElementById("salinity-display"),
            saltResult: document.getElementById("result-salt"),
            sugarResult: document.getElementById("result-sugar"),
            sugarPanel: document.getElementById("sugar-result-panel"),
            timeResult: document.getElementById("result-time"),
            timeLabel: document.getElementById("result-time-label"),
            visTotal: document.getElementById("vis-total-weight"),
        },
        vis: {
            water: document.getElementById("vis-water"),
            product: document.getElementById("vis-product"),
            particles: document.getElementById("vis-particles"),
        },
    };

    
    const calculate = () => {
        const totalWeight = state.product + state.water;
        const salt = totalWeight * (state.salinity / 100);
        const sugar = state.sugar ? salt * 0.5 : 0;
        return { salt, sugar, totalWeight };
    };

    
    const updateVisuals = (results: { salt: number; sugar: number; totalWeight: number }) => {
        
        
        const maxCap = 2000;
        const waterHeight = Math.min((state.water / maxCap) * 100, 90);
        if (els.vis.water) els.vis.water.style.height = `${Math.max(waterHeight, 10)}%`;

        
        const productSize = Math.min((state.product / maxCap) * 100, 80);
        if (els.vis.product) {
            els.vis.product.style.height = `${Math.max(productSize, 10)}%`;
            els.vis.product.style.width = `${Math.max(productSize, 20)}%`;
        }

        
        
        if (els.vis.particles) els.vis.particles.innerHTML = "";

        
        const saltCount = Math.min(Math.floor(results.salt / 2), 50); 
        for (let i = 0; i < saltCount; i++) {
            createParticle("bg-white", "animate-float");
        }

        
        if (state.sugar) {
            const sugarCount = Math.min(Math.floor(results.sugar / 2), 30);
            for (let i = 0; i < sugarCount; i++) {
                createParticle("bg-purple-400", "animate-pulse");
            }
        }
    };

    const createParticle = (colorClass: string, animClass: string) => {
        if (!els.vis.particles) return;
        const p = document.createElement("div");
        const size = Math.random() * 4 + 2; 
        p.className = `absolute rounded-full opacity-60 ${colorClass} ${animClass}`;
        p.style.width = `${size}px`;
        p.style.height = `${size}px`;
        p.style.left = `${Math.random() * 100}%`;
        p.style.bottom = `${Math.random() * 100}%`;
        p.style.animationDelay = `${Math.random() * 2}s`;
        els.vis.particles.appendChild(p);
    };

    const updatePresets = () => {
        els.inputs.presets.forEach((btn) => {
            const val = parseFloat(btn.getAttribute("data-value") || "0");
            const isSelected = Math.abs(val - state.salinity) < 0.01;

            
            const activeClasses = ["ring-2", "ring-offset-2", "dark:ring-offset-slate-900"];

            
            let specificClasses: string[] = [];
            if (val === 1.5)
                specificClasses = [
                    "ring-cyan-500",
                    "bg-cyan-100",
                    "text-cyan-700",
                    "dark:bg-cyan-900/30",
                    "dark:text-cyan-300",
                ];
            if (val === 2.0)
                specificClasses = [
                    "ring-emerald-500",
                    "bg-emerald-100",
                    "text-emerald-700",
                    "dark:bg-emerald-900/30",
                    "dark:text-emerald-300",
                ];
            if (val === 3.5)
                specificClasses = [
                    "ring-orange-500",
                    "bg-orange-100",
                    "text-orange-700",
                    "dark:bg-orange-900/30",
                    "dark:text-orange-300",
                ];
            if (val === 5.0)
                specificClasses = [
                    "ring-rose-500",
                    "bg-rose-100",
                    "text-rose-700",
                    "dark:bg-rose-900/30",
                    "dark:text-rose-300",
                ];

            if (isSelected) {
                btn.classList.add(...activeClasses);
                if (specificClasses.length) btn.classList.add(...specificClasses);
            } else {
                btn.classList.remove(...activeClasses);
                if (specificClasses.length) btn.classList.remove(...specificClasses);
            }
        });
    };

    
    const update = () => {
        const results = calculate();

        
        if (els.displays.saltResult)
            els.displays.saltResult.textContent = Math.round(results.salt).toString();
        if (els.displays.sugarResult)
            els.displays.sugarResult.textContent = Math.round(results.sugar).toString();
        if (els.displays.salinity) els.displays.salinity.textContent = state.salinity.toFixed(1);
        if (els.displays.visTotal)
            els.displays.visTotal.textContent = Math.round(results.totalWeight).toString();

        
        if (els.displays.sugarPanel) {
            if (state.sugar) els.displays.sugarPanel.classList.remove("hidden");
            else els.displays.sugarPanel.classList.add("hidden");
        }

        
        let timeText = "";
        let timeLabel = "";

        if (state.salinity < 2.0) {
            timeLabel = "Tiempo (Carnes)";
            timeText = "4 - 48 Horas";
        } else if (state.salinity <= 3.0) {
            timeLabel = "Tiempo (Vegetales)";
            timeText = "1 - 3 Semanas";
        } else {
            timeLabel = "Tiempo (Conservas)";
            timeText = "1+ Meses";
        }

        if (els.displays.timeResult) els.displays.timeResult.textContent = timeText;
        if (els.displays.timeLabel) els.displays.timeLabel.textContent = timeLabel;

        
        updateVisuals(results);
        updatePresets();
    };

    
    if (els.inputs.product)
        els.inputs.product.addEventListener("input", (e) => {
            state.product = parseFloat((e.target as HTMLInputElement).value) || 0;
            update();
        });

    if (els.inputs.water)
        els.inputs.water.addEventListener("input", (e) => {
            state.water = parseFloat((e.target as HTMLInputElement).value) || 0;
            update();
        });

    if (els.inputs.slider)
        els.inputs.slider.addEventListener("input", (e) => {
            state.salinity = parseFloat((e.target as HTMLInputElement).value);
            update();
        });

    if (els.inputs.sugar)
        els.inputs.sugar.addEventListener("change", (e) => {
            state.sugar = (e.target as HTMLInputElement).checked;
            update();
        });

    els.inputs.presets.forEach((btn) => {
        btn.addEventListener("click", () => {
            const val = parseFloat(btn.getAttribute("data-value") || "2.0");
            state.salinity = val;
            if (els.inputs.slider) els.inputs.slider.value = val.toString();
            update();
        });
    });

    
    update();
</script>
