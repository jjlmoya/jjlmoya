---
import { Icon } from 'astro-icon/components';
---

<div class="w-full max-w-5xl mx-auto px-4 md:px-0 py-12" id="cookware-selector">

    <div class="grid lg:grid-cols-2 gap-12 items-start">

        <!-- Controls Area -->
        <div class="space-y-12 relative z-20">
            
            <!-- Question 1: Style -->
            <div class="space-y-6">
                <h3 class="text-xl font-bold flex items-center gap-3 text-slate-900 dark:text-white">
                    <span class="w-8 h-8 rounded-full bg-slate-900 dark:bg-white text-white dark:text-slate-900 flex items-center justify-center text-sm">1</span>
                    ¿Cómo cocinas habitualmente?
                </h3>
                
                <div class="grid grid-cols-2 gap-4">
                    <button class="selector-card w-full text-left p-6 rounded-2xl border-2 border-slate-200 dark:border-slate-800 hover:border-slate-300 dark:hover:border-slate-700 transition-all group relative overflow-hidden" 
                            data-type="style" data-value="sear" onclick="selectOption('style', 'sear')">
                        <div class="relative z-10">
                            <Icon name="mdi:fire" class="w-10 h-10 mb-3 text-slate-400 group-hover:text-orange-500 transition-colors icon-el" />
                            <div class="font-bold text-lg text-slate-900 dark:text-white mb-1">Fuego Alto</div>
                            <div class="text-xs text-slate-500 font-medium uppercase tracking-wide">Dorar / Sellado</div>
                        </div>
                        <div class="absolute inset-0 bg-orange-50 dark:bg-orange-900/20 opacity-0 transition-opacity bg-el"></div>
                        <div class="absolute top-4 right-4 text-orange-500 opacity-0 scale-0 transition-all check-el">
                            <Icon name="mdi:check-circle" class="w-6 h-6" />
                        </div>
                    </button>

                    <button class="selector-card w-full text-left p-6 rounded-2xl border-2 border-slate-200 dark:border-slate-800 hover:border-slate-300 dark:hover:border-slate-700 transition-all group relative overflow-hidden" 
                            data-type="style" data-value="delicate" onclick="selectOption('style', 'delicate')">
                        <div class="relative z-10">
                            <Icon name="mdi:egg-fried" class="w-10 h-10 mb-3 text-slate-400 group-hover:text-yellow-500 transition-colors icon-el" />
                            <div class="font-bold text-lg text-slate-900 dark:text-white mb-1">Delicado</div>
                            <div class="text-xs text-slate-500 font-medium uppercase tracking-wide">Huevos / Pescado</div>
                        </div>
                        <div class="absolute inset-0 bg-yellow-50 dark:bg-yellow-900/20 opacity-0 transition-opacity bg-el"></div>
                        <div class="absolute top-4 right-4 text-yellow-500 opacity-0 scale-0 transition-all check-el">
                            <Icon name="mdi:check-circle" class="w-6 h-6" />
                        </div>
                    </button>

                    <button class="selector-card w-full text-left p-6 rounded-2xl border-2 border-slate-200 dark:border-slate-800 hover:border-slate-300 dark:hover:border-slate-700 transition-all group relative overflow-hidden" 
                            data-type="style" data-value="stew" onclick="selectOption('style', 'stew')">
                        <div class="relative z-10">
                            <Icon name="mdi:pot-mix" class="w-10 h-10 mb-3 text-slate-400 group-hover:text-red-500 transition-colors icon-el" />
                            <div class="font-bold text-lg text-slate-900 dark:text-white mb-1">Guisos</div>
                            <div class="text-xs text-slate-500 font-medium uppercase tracking-wide">Cocción Lenta</div>
                        </div>
                        <div class="absolute inset-0 bg-red-50 dark:bg-red-900/20 opacity-0 transition-opacity bg-el"></div>
                        <div class="absolute top-4 right-4 text-red-500 opacity-0 scale-0 transition-all check-el">
                            <Icon name="mdi:check-circle" class="w-6 h-6" />
                        </div>
                    </button>

                    <button class="selector-card w-full text-left p-6 rounded-2xl border-2 border-slate-200 dark:border-slate-800 hover:border-slate-300 dark:hover:border-slate-700 transition-all group relative overflow-hidden" 
                            data-type="style" data-value="fast" onclick="selectOption('style', 'fast')">
                        <div class="relative z-10">
                             <Icon name="mdi:flash" class="w-10 h-10 mb-3 text-slate-400 group-hover:text-blue-500 transition-colors icon-el" />
                            <div class="font-bold text-lg text-slate-900 dark:text-white mb-1">Rápido</div>
                            <div class="text-xs text-slate-500 font-medium uppercase tracking-wide">Salteados / Wok</div>
                        </div>
                        <div class="absolute inset-0 bg-blue-50 dark:bg-blue-900/20 opacity-0 transition-opacity bg-el"></div>
                        <div class="absolute top-4 right-4 text-blue-500 opacity-0 scale-0 transition-all check-el">
                            <Icon name="mdi:check-circle" class="w-6 h-6" />
                        </div>
                    </button>
                </div>
            </div>

            <!-- Question 2: Maintenance -->
            <div class="space-y-6">
                <h3 class="text-xl font-bold flex items-center gap-3 text-slate-900 dark:text-white">
                    <span class="w-8 h-8 rounded-full bg-slate-900 dark:bg-white text-white dark:text-slate-900 flex items-center justify-center text-sm">2</span>
                    ¿Cuánto quieres cuidarla?
                </h3>
                
                <div class="flex flex-col gap-3">
                    <button class="selector-card w-full flex items-center p-5 rounded-2xl border-2 border-slate-200 dark:border-slate-800 hover:border-slate-300 dark:hover:border-slate-700 transition-all group relative overflow-hidden"
                             data-type="maint" data-value="lazy" onclick="selectOption('maint', 'lazy')">
                        <div class="relative z-10 flex items-center gap-4 w-full">
                            <div class="w-12 h-12 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-slate-400 group-hover:text-green-500 transition-colors icon-box-el">
                                <Icon name="mdi:dishwasher" class="w-6 h-6" />
                            </div>
                            <div class="text-left">
                                <div class="font-bold text-lg text-slate-900 dark:text-white">Bajo / Nulo</div>
                                <div class="text-xs text-slate-500">"Todo al lavavajillas"</div>
                            </div>
                            <div class="ml-auto opacity-0 scale-0 transition-all check-el text-green-500">
                                <Icon name="mdi:check-circle" class="w-8 h-8" />
                            </div>
                        </div>
                        <div class="absolute inset-0 bg-green-50 dark:bg-green-900/10 opacity-0 transition-opacity bg-el"></div>
                    </button>

                     <button class="selector-card w-full flex items-center p-5 rounded-2xl border-2 border-slate-200 dark:border-slate-800 hover:border-slate-300 dark:hover:border-slate-700 transition-all group relative overflow-hidden"
                             data-type="maint" data-value="care" onclick="selectOption('maint', 'care')">
                        <div class="relative z-10 flex items-center gap-4 w-full">
                            <div class="w-12 h-12 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-slate-400 group-hover:text-blue-500 transition-colors icon-box-el">
                                <Icon name="mdi:hand-water" class="w-6 h-6" />
                            </div>
                            <div class="text-left">
                                <div class="font-bold text-lg text-slate-900 dark:text-white">Medio</div>
                                <div class="text-xs text-slate-500">"Lavo a mano sin problema"</div>
                            </div>
                            <div class="ml-auto opacity-0 scale-0 transition-all check-el text-blue-500">
                                <Icon name="mdi:check-circle" class="w-8 h-8" />
                            </div>
                        </div>
                        <div class="absolute inset-0 bg-blue-50 dark:bg-blue-900/10 opacity-0 transition-opacity bg-el"></div>
                    </button>

                    <button class="selector-card w-full flex items-center p-5 rounded-2xl border-2 border-slate-200 dark:border-slate-800 hover:border-slate-300 dark:hover:border-slate-700 transition-all group relative overflow-hidden"
                             data-type="maint" data-value="ritual" onclick="selectOption('maint', 'ritual')">
                        <div class="relative z-10 flex items-center gap-4 w-full">
                            <div class="w-12 h-12 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center text-slate-400 group-hover:text-amber-500 transition-colors icon-box-el">
                                <Icon name="mdi:diamond-stone" class="w-6 h-6" />
                            </div>
                            <div class="text-left">
                                <div class="font-bold text-lg text-slate-900 dark:text-white">Alto (Ritual)</div>
                                <div class="text-xs text-slate-500">"Quiero curar mi sartén"</div>
                            </div>
                            <div class="ml-auto opacity-0 scale-0 transition-all check-el text-amber-500">
                                <Icon name="mdi:check-circle" class="w-8 h-8" />
                            </div>
                        </div>
                        <div class="absolute inset-0 bg-amber-50 dark:bg-amber-900/10 opacity-0 transition-opacity bg-el"></div>
                    </button>
                </div>
            </div>

        </div>

        <!-- Result Card (Sticky) -->
        <div class="lg:sticky lg:top-8 perspective-1000">
            <div id="final-card" class="bg-slate-900 rounded-[2.5rem] p-1 text-white min-h-[600px] relative overflow-hidden shadow-2xl transition-all duration-700 border-4 border-slate-800">
                
                <!-- Background Gradient -->
                <div id="card-bg" class="rounded-[2.3rem] absolute inset-0 bg-slate-950 transition-all duration-1000"></div>
                
                <!-- Container -->
                <div class="relative z-10 w-full h-full flex flex-col p-8 md:p-10 justify-center">

                    <!-- STATE 1: MYSTERY (Default) -->
                    <div id="mystery-state" class="flex flex-col items-center justify-center h-full space-y-12 transition-all duration-500">
                        <div class="text-center space-y-2">
                             <div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-slate-800 border border-slate-700 text-slate-400 text-xs font-bold uppercase tracking-widest">
                                <Icon name="mdi:lock-outline" class="w-4 h-4" />
                                <span>Configurador</span>
                            </div>
                            <h3 class="text-3xl font-bold text-slate-700">Esperando datos...</h3>
                        </div>

                        <!-- Locks -->
                        <div class="flex items-center gap-4 md:gap-8">
                             <div id="lock-style" class="w-24 h-32 md:w-32 md:h-40 rounded-2xl bg-slate-800 border-2 border-slate-700 flex items-center justify-center text-slate-600 transition-all duration-500 shadow-inner">
                                <Icon name="mdi:help" class="w-12 h-12" />
                             </div>
                             <div id="lock-maint" class="w-24 h-32 md:w-32 md:h-40 rounded-2xl bg-slate-800 border-2 border-slate-700 flex items-center justify-center text-slate-600 transition-all duration-500 shadow-inner">
                                <Icon name="mdi:help" class="w-12 h-12" />
                             </div>
                        </div>
                        <p class="text-slate-500 text-sm max-w-xs text-center">Completa el formulario para desbloquear tu resultado.</p>
                    </div>

                    <!-- STATE 2: REVEAL -->
                    <div id="reveal-state" class="hidden h-full flex-col justify-between opacity-0 transition-opacity duration-500">
                         <!-- Top Badge -->
                        <div class="flex justify-between items-start mb-6">
                            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 backdrop-blur-md border border-white/10 text-yellow-400">
                                <Icon name="mdi:star" class="w-3 h-3" />
                                <span class="text-[10px] font-bold uppercase tracking-widest text-white/90">Resultado</span>
                            </div>
                        </div>

                        <!-- Content Center -->
                        <div class="flex-grow flex flex-col items-center justify-center text-center space-y-6">
                            
                            <!-- ICONS: Back to clear Astro Icons -->
                            <div class="relative group w-full flex justify-center items-center h-64">
                                <div class="absolute inset-0 bg-white/10 blur-[60px] rounded-full animate-pulse-slow pointer-events-none"></div>
                                
                                <div id="icon-stainless" class="result-icon hidden"><Icon name="mdi:shield-star-outline" class="w-48 h-48 md:w-56 md:h-56 drop-shadow-2xl" /></div>
                                <div id="icon-nonstick" class="result-icon hidden"><Icon name="mdi:feather" class="w-48 h-48 md:w-56 md:h-56 drop-shadow-2xl" /></div>
                                <div id="icon-castiron" class="result-icon hidden"><Icon name="mdi:weight-kilogram" class="w-48 h-48 md:w-56 md:h-56 drop-shadow-2xl" /></div>
                                <div id="icon-carbon" class="result-icon hidden"><Icon name="mdi:chef-hat" class="w-48 h-48 md:w-56 md:h-56 drop-shadow-2xl" /></div>
                                <div id="icon-enameled" class="result-icon hidden"><Icon name="mdi:pot" class="w-48 h-48 md:w-56 md:h-56 drop-shadow-2xl" /></div>
                            </div>

                            <div class="space-y-2 relative z-20">
                                <h3 class="text-4xl md:text-5xl font-black tracking-tight drop-shadow-lg" id="res-name">Calculando...</h3>
                                <p class="text-lg text-white/80 font-medium drop-shadow-md" id="res-tag">...</p>
                            </div>
                        </div>

                        <!-- Footer -->
                         <div class="grid grid-cols-2 gap-4 mt-8 opacity-0 transition-opacity duration-1000 delay-500" id="res-footer">
                            <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/5">
                                <div class="text-green-400 text-[10px] font-bold uppercase mb-1 flex items-center gap-1">
                                    <Icon name="mdi:check" class="w-3 h-3" /> Pro
                                </div>
                                <p class="text-sm leading-tight text-white/90" id="res-pros">-</p>
                            </div>
                            <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/5">
                                <div class="text-red-400 text-[10px] font-bold uppercase mb-1 flex items-center gap-1">
                                    <Icon name="mdi:close" class="w-3 h-3" /> Contra
                                </div>
                                <p class="text-sm leading-tight text-white/90" id="res-cons">-</p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>

    </div>

</div>

<script is:inline>
    const STATE = {
        style: null,
        maint: null,
        isRevealed: false
    };

    const DB = {
        'stainless': {
            name: 'Acero Inoxidable',
            tag: 'Todoterreno Profesional',
            gradient: 'from-slate-500 to-slate-900',
            pros: 'Eterna. No se raya. Dora increíble.',
            cons: 'Se pega si no sabes usarla (Tª).'
        },
        'nonstick': {
            name: 'Antiadherente',
            tag: 'La Fácil de Usar',
            gradient: 'from-zinc-700 to-black',
            pros: 'Nada se pega. Cero esfuerzo.',
            cons: 'Dura poco (2 años). No fuego fuerte.'
        },
        'castiron': {
            name: 'Hierro Fundido',
            tag: 'La Clásica Pesada',
            gradient: 'from-orange-900 to-black',
            pros: 'Retiene calor como ninguna.',
            cons: 'Pesa mucho. Requiere mantenimiento.'
        },
        'carbon': {
            name: 'Acero al Carbono',
            tag: 'El Wok Style',
            gradient: 'from-blue-900 to-slate-900',
            pros: 'Ligera, rápida y antiadherente natural.',
            cons: 'Fea visualmente, se mancha.'
        },
        'enameled': {
            name: 'Hierro Esmaltado',
            tag: 'La Joya (Le Creuset)',
            gradient: 'from-red-600 to-red-950',
            pros: 'Preciosa. Calor del hierro sin curado.',
            cons: 'Muy cara y frágil a golpes.'
        },
    }

    const LOGIC = {
        'sear':     { 'lazy': 'stainless', 'care': 'stainless', 'ritual': 'castiron' },
        'delicate': { 'lazy': 'nonstick',  'care': 'nonstick',  'ritual': 'carbon' },
        'stew':     { 'lazy': 'stainless', 'care': 'enameled',  'ritual': 'enameled' },
        'fast':     { 'lazy': 'stainless', 'care': 'stainless', 'ritual': 'carbon' }
    };

    function selectOption(type, value) {
        STATE[type] = value;
        STATE.isRevealed = false;

        document.querySelectorAll(`.selector-card[data-type="${type}"]`).forEach(btn => {
            if(btn.dataset.value === value) {
                btn.classList.add('selected');
                const color = {
                    'sear': '#f97316', 'delicate': '#eab308', 'stew': '#ef4444', 'fast': '#3b82f6',
                    'lazy': '#22c55e', 'care': '#3b82f6', 'ritual': '#f59e0b'
                }[value] || '#64748b';
                btn.style.borderColor = color;
            } else {
                btn.classList.remove('selected');
                btn.style.borderColor = '';
            }
        });

        updateLocks(type, value);

        if (STATE.style && STATE.maint) {
            const key = LOGIC[STATE.style][STATE.maint] || 'stainless';
            showResult(key);
        } else {
            showMystery();
        }
    }

    function updateLocks(type, value) {
        const lockId = type === 'style' ? 'lock-style' : 'lock-maint';
        const lockEl = document.getElementById(lockId);
        lockEl.classList.remove('bg-slate-800', 'text-slate-600', 'border-slate-700');
        lockEl.classList.add('bg-white', 'text-slate-900', 'border-white', 'shadow-[0_0_20px_rgba(255,255,255,0.3)]');
        lockEl.innerHTML = `<svg viewBox="0 0 24 24" class="w-10 h-10 text-green-500" fill="currentColor"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" /></svg>`;
    }

    function showMystery() {
        document.getElementById('mystery-state').classList.remove('hidden');
        document.getElementById('reveal-state').classList.add('hidden');
        document.getElementById('reveal-state').classList.remove('flex');
        document.getElementById('res-footer').classList.add('opacity-0');
        document.getElementById('card-bg').className = "rounded-[2.3rem] absolute inset-0 bg-slate-950 transition-all duration-1000";
    }

    function showResult(key) {
        const data = DB[key];
        
        // Data
        document.getElementById('res-name').textContent = data.name;
        document.getElementById('res-tag').textContent = data.tag;
        document.getElementById('res-pros').textContent = data.pros;
        document.getElementById('res-cons').textContent = data.cons;
        
        // Background
        const bg = document.getElementById('card-bg');
        bg.className = `rounded-[2.3rem] absolute inset-0 bg-gradient-to-br transition-all duration-1000 ${data.gradient}`;
        
        // State Layout
        const mysteryEl = document.getElementById('mystery-state');
        const revealEl = document.getElementById('reveal-state');
        
        // Hide Mystery
        mysteryEl.classList.add('hidden');
        
        // Show Reveal (Remove hidden, add flex, fix opacity)
        revealEl.classList.remove('hidden', 'opacity-0');
        revealEl.classList.add('flex', 'opacity-100');
        
        // Icon Switching (Safe Static Method)
        document.querySelectorAll('.result-icon').forEach(el => el.classList.add('hidden'));
        const iconEl = document.getElementById('icon-' + key);
        if(iconEl) iconEl.classList.remove('hidden');

        // Footer Fade
        setTimeout(() => {
            document.getElementById('res-footer').classList.remove('opacity-0');
        }, 100);
    }
</script>

<style>
    /* Absolute styling for the selected state to guarantee visibility */
    .selector-card.selected {
        background-color: white;
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
        transform: scale(1.02);
        z-index: 10;
        border-width: 3px;
    }
    
    html.dark .selector-card.selected {
        background-color: #0f172a;
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.5);
    }

    .selector-card.selected .check-el { opacity: 1 !important; transform: scale(1) !important; }
    .selector-card.selected .bg-el { opacity: 1 !important; }
    .selector-card.selected .icon-el { color: inherit; }

    @keyframes pulse-slow {
        0%, 100% { opacity: 0.5; transform: scale(1); }
        50% { opacity: 1; transform: scale(1.05); }
    }
    .animate-pulse-slow {
        animation: pulse-slow 2s infinite ease-in-out;
    }
</style>
