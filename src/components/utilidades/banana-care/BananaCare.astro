---

---

<div
    class="banana-care-container bg-white/10 dark:bg-zinc-900/40 backdrop-blur-xl border border-white/20 dark:border-zinc-800/50 rounded-[2.5rem] p-6 md:p-10 shadow-2xl overflow-hidden relative group"
>
    
    <div
        class="absolute -top-24 -right-24 w-64 h-64 bg-yellow-400/20 rounded-full blur-3xl pointer-events-none group-hover:bg-yellow-400/30 transition-all duration-700"
    >
    </div>
    <div
        class="absolute -bottom-24 -left-24 w-64 h-64 bg-emerald-400/10 rounded-full blur-3xl pointer-events-none group-hover:bg-emerald-400/20 transition-all duration-700"
    >
    </div>

    <div
        class="relative z-10 max-w-5xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8 items-center"
    >
        
        <div class="lg:col-span-12 xl:col-span-5 flex flex-col items-center justify-center">
            <div
                id="status-card"
                class="relative w-full max-w-[340px] aspect-square flex items-center justify-center"
            >
                <div
                    id="glow-indicator"
                    class="absolute inset-0 rounded-full blur-[60px] opacity-20 transition-all duration-1000"
                >
                </div>

                <div
                    id="status-visual-indicator"
                    class="relative z-10 transition-all duration-700 ease-out"
                >
                    <svg
                        viewBox="0 0 240 200"
                        class="w-full h-full drop-shadow-2xl"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <g id="banana-group" class="transition-all duration-700 origin-center">
                            
                            <path
                                id="banana-body"
                                d="M50,20 Q10,120 100,170 Q180,190 200,140 Q110,175 50,20"
                                fill="currentColor"
                                class="text-yellow-400 transition-colors duration-500"></path>

                            
                            <path
                                d="M55,25 Q25,115 105,160 Q170,175 195,138"
                                fill="none"
                                stroke="rgba(0,0,0,0.1)"
                                stroke-width="2"
                                stroke-linecap="round"></path>

                            
                            <path d="M50,20 L40,5 C38,2 45,-2 50,2 L58,16 Z" fill="#2d1302"></path>

                            
                            <path d="M200,140 L206,142 L202,148 Z" fill="#2d1302"></path>

                            
                            <g id="dots-container">
                                <circle
                                    class="banana-dot opacity-0"
                                    cx="75"
                                    cy="110"
                                    r="4.5"
                                    fill="#311102"></circle>
                                <circle
                                    class="banana-dot opacity-0"
                                    cx="105"
                                    cy="148"
                                    r="3.2"
                                    fill="#311102"></circle>
                                <circle
                                    class="banana-dot opacity-0"
                                    cx="150"
                                    cy="165"
                                    r="5"
                                    fill="#311102"></circle>
                                <circle
                                    class="banana-dot opacity-0"
                                    cx="50"
                                    cy="80"
                                    r="2.8"
                                    fill="#311102"></circle>
                                <circle
                                    class="banana-dot opacity-0"
                                    cx="125"
                                    cy="158"
                                    r="3.8"
                                    fill="#311102"></circle>
                                <circle
                                    class="banana-dot opacity-0"
                                    cx="178"
                                    cy="155"
                                    r="2.5"
                                    fill="#311102"></circle>
                            </g>
                        </g>
                    </svg>
                </div>
            </div>

            <div class="mt-4 text-center">
                <div
                    class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-white/10 dark:bg-black/20 border border-white/20 dark:border-white/5 backdrop-blur-md mb-2"
                >
                    <div id="status-color-dot" class="w-2.5 h-2.5 rounded-full shadow-lg"></div>
                    <span
                        id="status-name"
                        class="text-sm font-black uppercase tracking-[0.2em] text-zinc-900 dark:text-white leading-none"
                        >...</span
                    >
                </div>
                <p
                    id="status-description"
                    class="text-xs text-zinc-500 dark:text-zinc-400 font-bold max-w-[280px] mx-auto min-h-[3em]"
                >
                </p>
            </div>
        </div>

        
        <div class="lg:col-span-12 xl:col-span-7 space-y-6">
            <div
                class="p-8 rounded-[2rem] bg-white/40 dark:bg-black/20 border border-white/40 dark:border-white/5 shadow-xl space-y-8 backdrop-blur-md"
            >
                
                <div class="space-y-4">
                    <div class="flex justify-between items-end">
                        <span
                            class="text-[10px] font-black uppercase tracking-[0.3em] text-zinc-400"
                            >Estado de Maduración</span
                        >
                        <span
                            id="level-display"
                            class="text-3xl font-black text-yellow-500 tabular-nums">2.0</span
                        >
                    </div>
                    <input
                        type="range"
                        id="ripeness-slider"
                        min="1"
                        max="5"
                        step="0.01"
                        value="2"
                        class="w-full h-3 bg-zinc-200 dark:bg-zinc-800 rounded-full appearance-none cursor-pointer accent-yellow-500"
                    />
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    
                    <div
                        class="p-6 rounded-3xl bg-yellow-400/5 dark:bg-yellow-400/10 border border-yellow-400/20 text-center flex flex-col justify-center"
                    >
                        <span
                            class="text-[10px] font-black uppercase tracking-widest text-yellow-600 dark:text-yellow-500 mb-2"
                            >Próxima Etapa en</span
                        >
                        <div class="flex items-baseline justify-center gap-1">
                            <span
                                id="days-prediction"
                                class="text-6xl font-black text-zinc-900 dark:text-white tabular-nums"
                                >2.5</span
                            >
                            <span class="text-xs font-black text-zinc-400 uppercase">Días</span>
                        </div>
                    </div>

                    
                    <div class="space-y-4">
                        <div
                            class="p-4 rounded-2xl bg-indigo-500/5 border border-indigo-500/10 transition-all hover:bg-indigo-500/10"
                        >
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-[9px] font-black uppercase text-indigo-500"
                                    >Temperatura</span
                                >
                                <span
                                    id="temp-display"
                                    class="text-xs font-mono font-bold text-indigo-600 dark:text-indigo-400"
                                    >20°C</span
                                >
                            </div>
                            <input
                                type="range"
                                id="temp-slider"
                                min="5"
                                max="40"
                                value="20"
                                class="w-full h-1 bg-indigo-200 dark:bg-indigo-900/50 rounded-full appearance-none cursor-pointer accent-indigo-500"
                            />
                        </div>
                        <div
                            class="p-4 rounded-2xl bg-blue-500/5 border border-blue-500/10 transition-all hover:bg-blue-500/10"
                        >
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-[9px] font-black uppercase text-blue-500"
                                    >Humedad</span
                                >
                                <span
                                    id="humidity-display"
                                    class="text-xs font-mono font-bold text-blue-600 dark:text-blue-400"
                                    >50%</span
                                >
                            </div>
                            <input
                                type="range"
                                id="humidity-slider"
                                min="10"
                                max="95"
                                value="50"
                                class="w-full h-1 bg-blue-200 dark:bg-blue-900/50 rounded-full appearance-none cursor-pointer accent-blue-500"
                            />
                        </div>
                    </div>
                </div>

                
                <button
                    id="partner-toggle"
                    class="w-full p-5 rounded-2xl border border-emerald-500/20 bg-emerald-500/5 flex items-center justify-between group transition-all hover:bg-emerald-500/10"
                >
                    <div class="flex items-center gap-4 text-left">
                        <div
                            class="p-3 rounded-2xl bg-emerald-500/20 text-emerald-600 group-hover:scale-110 transition-transform"
                        >
                            <div
                                class="w-4 h-4 rounded-full border-2 border-current flex items-center justify-center"
                            >
                                <div class="w-1.5 h-1.5 rounded-full bg-current"></div>
                            </div>
                        </div>
                        <div>
                            <h4 class="text-xs font-black text-zinc-900 dark:text-white uppercase">
                                Acompañamiento Climatérico
                            </h4>
                            <p class="text-[10px] text-zinc-500 font-bold uppercase tracking-tight">
                                Efecto etileno externo
                            </p>
                        </div>
                    </div>
                    <div
                        class="w-12 h-6 rounded-full bg-zinc-200 dark:bg-zinc-800 relative border border-zinc-300 dark:border-zinc-700"
                    >
                        <div
                            id="toggle-circle"
                            class="absolute left-1 top-1 w-4 h-4 rounded-full bg-white shadow-md transition-transform duration-300"
                        >
                        </div>
                    </div>
                </button>

                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div
                        class="p-6 rounded-3xl bg-zinc-100/50 dark:bg-zinc-800/40 border border-zinc-200 dark:border-zinc-700/50"
                    >
                        <h5
                            class="text-[9px] font-black uppercase tracking-[0.2em] text-zinc-400 mb-2"
                        >
                            Conservación
                        </h5>
                        <p
                            id="status-conservation"
                            class="text-xs text-zinc-600 dark:text-zinc-300 leading-relaxed font-bold"
                        >
                        </p>
                    </div>
                    <div
                        class="p-6 rounded-3xl bg-yellow-400/5 dark:bg-yellow-400/10 border border-yellow-400/20"
                    >
                        <h5
                            class="text-[9px] font-black uppercase tracking-[0.2em] text-yellow-600 mb-2"
                        >
                            Aceleración
                        </h5>
                        <p
                            id="status-acceleration"
                            class="text-xs text-zinc-900 dark:text-white leading-relaxed font-black italic"
                        >
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    #ripeness-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 36px;
        height: 36px;
        background: #fbbf24;
        cursor: pointer;
        border-radius: 50%;
        border: 4px solid white;
        box-shadow: 0 10px 25px rgba(251, 191, 36, 0.4);
        transition: all 0.2s;
    }

    .dark #ripeness-slider::-webkit-slider-thumb {
        border-color: #18181b;
    }

    #ripeness-slider:active::-webkit-slider-thumb {
        transform: scale(0.9);
    }

    .banana-dot {
        transition: opacity 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
</style>

<script>
    import { BananaEngine } from "./BananaEngine";

    const slider = document.getElementById("ripeness-slider") as HTMLInputElement;
    const tempSlider = document.getElementById("temp-slider") as HTMLInputElement;
    const humiditySlider = document.getElementById("humidity-slider") as HTMLInputElement;
    const partnerToggle = document.getElementById("partner-toggle");

    const levelDisplay = document.getElementById("level-display");
    const tempDisplay = document.getElementById("temp-display");
    const humidityDisplay = document.getElementById("humidity-display");

    const statusName = document.getElementById("status-name");
    const statusDesc = document.getElementById("status-description");
    const statusCons = document.getElementById("status-conservation");
    const statusAccel = document.getElementById("status-acceleration");
    const daysPrediction = document.getElementById("days-prediction");
    const bananaBody = document.getElementById("banana-body");
    const bananaGroup = document.getElementById("banana-group");
    const glowIndicator = document.getElementById("glow-indicator");
    const colorDot = document.getElementById("status-color-dot");
    const toggleCircle = document.getElementById("toggle-circle");
    const dots = document.querySelectorAll(".banana-dot");

    let hasPartners = false;

    partnerToggle?.addEventListener("click", () => {
        hasPartners = !hasPartners;
        if (partnerToggle) {
            partnerToggle.classList.toggle("bg-emerald-500", hasPartners);
            partnerToggle.classList.toggle("bg-zinc-200", !hasPartners);
            if (!hasPartners) partnerToggle.classList.add("dark:bg-zinc-800");
        }
        if (toggleCircle) {
            toggleCircle.classList.toggle("translate-x-6", hasPartners);
        }
        update();
    });

    function update() {
        const level = parseFloat(slider.value);
        const temp = parseInt(tempSlider.value);
        const humidity = parseInt(humiditySlider.value);
        const status = BananaEngine.getStatus(level);

        if (levelDisplay) levelDisplay.innerText = level.toFixed(1);
        if (tempDisplay) tempDisplay.innerText = `${temp}°C`;
        if (humidityDisplay) humidityDisplay.innerText = `${humidity}%`;

        if (statusName) statusName.innerText = status.name;
        if (statusDesc) statusDesc.innerText = status.description;
        if (statusCons) statusCons.innerText = status.conservation;
        if (statusAccel) statusAccel.innerText = status.acceleration;

        if (bananaBody) {
            bananaBody.style.color = status.color;
        }

        if (colorDot) {
            colorDot.style.backgroundColor = status.color;
            colorDot.style.boxShadow = `0 0 15px ${status.color}`;
        }

        if (bananaGroup) {
            bananaGroup.style.transform = `rotate(${level * 5 - 12}deg) scale(${1 + (level - 2.5) * 0.05})`;
        }

        if (glowIndicator) {
            glowIndicator.style.backgroundColor = status.color;
            glowIndicator.style.opacity = (level / 12).toString();
        }

        dots.forEach((dot, index) => {
            const threshold = 2.4 + index * 0.35;
            if (level >= threshold) {
                dot.classList.remove("opacity-0");
                dot.classList.add("opacity-80");
            } else {
                dot.classList.remove("opacity-80");
                dot.classList.add("opacity-0");
            }
        });

        const days = BananaEngine.calculateDays(level, temp, humidity, hasPartners);
        if (daysPrediction) daysPrediction.innerText = days.toString();
    }

    slider?.addEventListener("input", update);
    tempSlider?.addEventListener("input", update);
    humiditySlider?.addEventListener("input", update);

    update();
</script>
