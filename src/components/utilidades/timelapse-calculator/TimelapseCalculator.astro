---
import { Icon } from "astro-icon/components";
---

<div
    class="w-full max-w-5xl mx-auto bg-white dark:bg-slate-900 rounded-3xl shadow-2xl overflow-hidden border border-slate-200 dark:border-slate-700"
>
    <div class="grid grid-cols-1 lg:grid-cols-2">
        <div class="p-8 md:p-12 space-y-8 bg-slate-50 dark:bg-slate-900/50">
            <h3 class="text-xl font-black text-slate-800 dark:text-white flex items-center gap-2">
                <Icon name="mdi:tune-vertical" class="text-indigo-500" />
                Parámetros
            </h3>

            <div class="space-y-6">
                
                <div class="space-y-3">
                    <label
                        class="text-xs font-bold uppercase tracking-wider text-slate-500 delay-100"
                    >
                        ¿Cuánto dura el evento real?
                    </label>
                    <div class="flex gap-4">
                        <div class="flex-1">
                            <label for="event-hours" class="block text-xs text-slate-400 mb-1 ml-1"
                                >Horas</label
                            >
                            <input
                                type="number"
                                id="event-hours"
                                value="1"
                                min="0"
                                class="w-full bg-white dark:bg-slate-800 border-2 border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-2xl font-bold text-slate-700 dark:text-white focus:outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 dark:focus:ring-indigo-900 transition-all"
                            />
                        </div>
                        <div class="flex-1">
                            <label
                                for="event-minutes"
                                class="block text-xs text-slate-400 mb-1 ml-1">Minutos</label
                            >
                            <input
                                type="number"
                                id="event-minutes"
                                value="0"
                                min="0"
                                max="59"
                                class="w-full bg-white dark:bg-slate-800 border-2 border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-2xl font-bold text-slate-700 dark:text-white focus:outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 dark:focus:ring-indigo-900 transition-all"
                            />
                        </div>
                    </div>
                </div>

                
                <div class="space-y-3">
                    <label
                        class="text-xs font-bold uppercase tracking-wider text-slate-500 delay-100"
                    >
                        ¿Cómo quieres el video final?
                    </label>
                    <div class="flex gap-4">
                        <div class="flex-1">
                            <label
                                for="video-seconds"
                                class="block text-xs text-slate-400 mb-1 ml-1">Duración (seg)</label
                            >
                            <input
                                type="number"
                                id="video-seconds"
                                value="10"
                                min="1"
                                class="w-full bg-white dark:bg-slate-800 border-2 border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-2xl font-bold text-slate-700 dark:text-white focus:outline-none focus:border-pink-500 focus:ring-2 focus:ring-pink-200 dark:focus:ring-pink-900 transition-all"
                            />
                        </div>
                        <div class="flex-1">
                            <label for="fps-select" class="block text-xs text-slate-400 mb-1 ml-1"
                                >FPS</label
                            >
                            <div class="relative">
                                <select
                                    id="fps-select"
                                    class="w-full bg-white dark:bg-slate-800 border-2 border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-2xl font-bold text-slate-700 dark:text-white focus:outline-none focus:border-pink-500 focus:ring-2 focus:ring-pink-200 dark:focus:ring-pink-900 transition-all appearance-none"
                                >
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="30">30</option>
                                    <option value="60">60</option>
                                </select>
                                <Icon
                                    name="mdi:chevron-down"
                                    class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none text-xl"
                                />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        
        <div
            class="p-8 md:p-12 bg-gradient-to-br from-indigo-600 to-violet-700 text-white flex flex-col justify-between"
        >
            <div>
                <h3 class="text-xl font-black text-indigo-100 mb-8 flex items-center gap-2">
                    <Icon name="mdi:equal-box" class="text-indigo-300" />
                    Resultados
                </h3>

                <div class="space-y-2 mb-12">
                    <p class="text-indigo-200 text-sm font-bold uppercase tracking-widest">
                        Configura tu intervalómetro a:
                    </p>
                    <div class="flex items-baseline gap-2">
                        <span
                            id="result-interval"
                            class="text-6xl md:text-7xl font-black tracking-tighter"
                        >
                            15.0
                        </span>
                        <span class="text-2xl md:text-3xl font-bold text-indigo-300">segundos</span>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-8">
                    <div>
                        <p class="text-indigo-200 text-xs font-bold uppercase tracking-widest mb-1">
                            Total Fotos
                        </p>
                        <p id="result-photos" class="text-3xl font-bold font-mono">240</p>
                    </div>
                    <div>
                        <p class="text-indigo-200 text-xs font-bold uppercase tracking-widest mb-1">
                            Velocidad
                        </p>
                        <p id="result-speed" class="text-3xl font-bold font-mono">360x</p>
                    </div>
                    <div>
                        <p class="text-indigo-200 text-xs font-bold uppercase tracking-widest mb-1">
                            Duración Disparo
                        </p>
                        <p id="result-shutter" class="text-xl font-bold font-mono text-indigo-100">
                            ~7.5s (180°)
                        </p>
                    </div>
                    <div>
                        <p class="text-indigo-200 text-xs font-bold uppercase tracking-widest mb-1">
                            Peso (RAW)
                        </p>
                        <p id="result-storage" class="text-xl font-bold font-mono text-indigo-100">
                            ~6 GB
                        </p>
                    </div>
                </div>
            </div>

            <div class="mt-12 pt-8 border-t border-indigo-500/30">
                <div class="flex items-center gap-4 text-indigo-200 text-sm">
                    <Icon name="mdi:information-outline" class="text-2xl flex-shrink-0" />
                    <p class="leading-tight">
                        La regla de los 180° sugiere una velocidad de obturación de la mitad del
                        intervalo para un movimiento fluido.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const eventHours = document.getElementById("event-hours") as HTMLInputElement;
    const eventMinutes = document.getElementById("event-minutes") as HTMLInputElement;
    const videoSeconds = document.getElementById("video-seconds") as HTMLInputElement;
    const fpsSelect = document.getElementById("fps-select") as HTMLSelectElement;

    const resultInterval = document.getElementById("result-interval");
    const resultPhotos = document.getElementById("result-photos");
    const resultStorage = document.getElementById("result-storage");
    const resultSpeed = document.getElementById("result-speed");
    const resultShutter = document.getElementById("result-shutter");

    function calculate() {
        const hrs = parseFloat(eventHours.value) || 0;
        const mins = parseFloat(eventMinutes.value) || 0;
        const eventSecs = hrs * 3600 + mins * 60;

        const vidSecs = parseFloat(videoSeconds.value) || 0;
        const fps = parseInt(fpsSelect.value) || 24;

        const totalFrames = vidSecs * fps;
        let interval = 0;

        if (totalFrames > 0 && eventSecs > 0) {
            interval = eventSecs / totalFrames;
        }

        const rawSize = totalFrames * 25;
        const gbSize = rawSize / 1024;
        const speed = vidSecs > 0 ? eventSecs / vidSecs : 0;
        const shutterSpeed = interval / 2;

        if (resultInterval)
            resultInterval.innerText = interval < 1 ? interval.toFixed(2) : interval.toFixed(1);
        if (resultPhotos) resultPhotos.innerText = totalFrames.toLocaleString("es-ES");
        if (resultStorage) resultStorage.innerText = `~${gbSize.toFixed(1)} GB`;
        if (resultSpeed) resultSpeed.innerText = `${speed.toFixed(0)}x`;
        if (resultShutter)
            resultShutter.innerText =
                shutterSpeed < 1
                    ? `1/${Math.round(1 / shutterSpeed)}s`
                    : `${shutterSpeed.toFixed(1)}s`;
    }

    eventHours?.addEventListener("input", calculate);
    eventMinutes?.addEventListener("input", calculate);
    videoSeconds?.addEventListener("input", calculate);
    fpsSelect?.addEventListener("change", calculate);

    
    calculate();
</script>
