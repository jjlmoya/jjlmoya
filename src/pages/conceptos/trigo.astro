---
import Layout from "../../layouts/Layout.astro";
// Force rebuild: Trigo Refactor
import TrigoHeader from "../../components/pages/trigo/TrigoHeader.astro";
import TrigoDeepTime from "../../components/pages/trigo/TrigoDeepTime.astro";
import TrigoRachis from "../../components/pages/trigo/TrigoRachis.astro";
import TrigoTrap from "../../components/pages/trigo/TrigoTrap.astro";
import TrigoGrindingRoutine from "../../components/pages/trigo/TrigoGrindingRoutine.astro";
import TrigoSurplus from "../../components/pages/trigo/TrigoSurplus.astro";
import TrigoSkeletonCompare from "../../components/pages/trigo/TrigoSkeletonCompare.astro";
import TrigoCalorieHunter from "../../components/pages/trigo/TrigoCalorieHunter.astro";
import TrigoCalorieFarmer from "../../components/pages/trigo/TrigoCalorieFarmer.astro";
import TrigoSocialContract from "../../components/pages/trigo/TrigoSocialContract.astro";
import TrigoPopulationGraph from "../../components/pages/trigo/TrigoPopulationGraph.astro";
import TrigoFuture from "../../components/pages/trigo/TrigoFuture.astro";
import TrigoModernMap from "../../components/pages/trigo/TrigoModernMap.astro";
import TrigoEpilogue from "../../components/pages/trigo/TrigoEpilogue.astro";
import TrigoDocumentation from "../../components/pages/trigo/TrigoDocumentation.astro";
import TrigoTableOfContents from "../../components/pages/trigo/TrigoTableOfContents.astro";
import TrigoWorkHoursChart from "../../components/pages/trigo/TrigoWorkHoursChart.astro";
import TrigoPositiveSecurity from "../../components/pages/trigo/TrigoPositiveSecurity.astro";
import TrigoPositiveSpecialization from "../../components/pages/trigo/TrigoPositiveSpecialization.astro";
import TrigoPositiveWriting from "../../components/pages/trigo/TrigoPositiveWriting.astro";
import TrigoPositiveCity from "../../components/pages/trigo/TrigoPositiveCity.astro";
import TrigoPositiveTrade from "../../components/pages/trigo/TrigoPositiveTrade.astro";
import TrigoPositiveBeer from "../../components/pages/trigo/TrigoPositiveBeer.astro";
import TrigoPositiveLaw from "../../components/pages/trigo/TrigoPositiveLaw.astro";
import TrigoPositiveKnowledge from "../../components/pages/trigo/TrigoPositiveKnowledge.astro";
import TrigoPositiveExpansion from "../../components/pages/trigo/TrigoPositiveExpansion.astro";
import TrigoPositiveDocumentation from "../../components/pages/trigo/TrigoPositiveDocumentation.astro";
---

<Layout
    title="La Historia del Trigo - Crónica de una transformación lenta"
    description="Una exploración visual y narrativa sobre cómo el trigo transformó a la humanidad, desde el tiempo profundo hasta la era moderna."
    fullWidth={true}
>
    <style is:global>
        main {
            counter-reset: trigo-chapter trigo-positive-chapter 10;
            scroll-behavior: smooth;
        }
        .trigo-chapter::before {
            counter-increment: trigo-chapter;
            content: counter(trigo-chapter, upper-roman) ". ";
        }

        .trigo-positive-chapter::before {
            counter-increment: trigo-positive-chapter -1;
            content: counter(trigo-positive-chapter, upper-roman) ". ";
        }

        /* Dynamic Background Colors & Scroll Snap */
        main > section {
            min-height: 100vh;
            scroll-snap-align: start;
        }
        main > section:nth-child(odd) {
            background-color: #0c0a09;
        }
        main > section:nth-child(even) {
            background-color: #1c1917;
        }
    </style>
    <TrigoTableOfContents />
    <main class="h-screen overflow-y-auto snap-y snap-mandatory text-[#e7e5e4]">
        <!-- Positive History (Scroll Up) -->
        <TrigoPositiveDocumentation />
        <TrigoPositiveExpansion />
        <TrigoPositiveKnowledge />
        <TrigoPositiveSpecialization />
        <TrigoPositiveLaw />
        <TrigoPositiveBeer />
        <TrigoPositiveTrade />
        <TrigoPositiveWriting />
        <TrigoPositiveCity />
        <TrigoPositiveSecurity />

        <!-- Center Point -->
        <TrigoHeader />

        <!-- Negative History (Scroll Down) -->
        <TrigoDeepTime />
        <TrigoRachis />
        <TrigoTrap />
        <TrigoGrindingRoutine />
        <TrigoSkeletonCompare />
        <TrigoCalorieHunter />
        <TrigoCalorieFarmer />
        <TrigoSurplus />
        <TrigoSocialContract />
        <TrigoPopulationGraph />
        <TrigoWorkHoursChart />
        <TrigoModernMap />
        <TrigoFuture />
        <TrigoEpilogue />
        <TrigoDocumentation />
    </main>

    <script>
        function scrollToStart() {
            const introSection = document.getElementById("intro");
            if (introSection) {
                // Instant jump, no smooth scroll for initialization
                introSection.scrollIntoView({ behavior: "auto", block: "start" });
            }
        }

        // Try immediately
        scrollToStart();

        // Try on DOM ready
        document.addEventListener("DOMContentLoaded", scrollToStart);

        // Try on full load (images etc)
        window.addEventListener("load", () => {
            // Only if we haven't scrolled yet (optional check, but forcing is safer for this specific UX)
            scrollToStart();
        });

        // Support Astro View Transitions
        document.addEventListener("astro:page-load", scrollToStart);
    </script>
</Layout>
